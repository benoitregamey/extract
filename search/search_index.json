{"config": {"lang": ["en"], "separator": "[\\s\\-]+", "pipeline": ["stopWordFilter"], "fields": {"title": {"boost": 1000.0}, "text": {"boost": 1.0}, "tags": {"boost": 1000000.0}}}, "docs": [{"location": "", "title": "Introduction", "text": ""}, {"location": "#what-is-extract", "title": "What is Extract ?", "text": "Extract is a web application that facilitates the extraction and delivery of your geodata ! <p>The Extract application imports data requests from a platform or data portal (such as the ASIT portals viageo.ch and plans-reseaux.ch), then executes a series of pre-configured tasks to extract the requested data, then returns the given result back to the client. </p> <p>And all of that with or without human intervention, you choose it !</p>"}, {"location": "#key-features", "title": "Key features", "text": "<ul> <li> Automate the process of extracting, transforming and delivering your geodata</li> <li> reduce order processing times</li> <li> increase delivered data quality</li> <li> increase customer satisfaction</li> </ul>"}, {"location": "#open-source-project", "title": "Open Source project", "text": "<p>Extract is a modular and extensible web application, to be installed in the IT environment of each data provider, and can be accessed with a web browser.</p> <p> </p>"}, {"location": "extract-connector-sample/", "title": "Extract - Initialize a New Connector Plugin", "text": ""}, {"location": "extract-connector-sample/#introduction", "title": "Introduction", "text": "<p>This Java module is an example of a connector plugin that can be used to initialize a new plugin for the Extract project. The source code is documented and provides the necessary guidance to develop a new plugin. It can be imported into a new Java environment, but adaptations may be required depending on the expected behavior.</p>"}, {"location": "extract-connector-sample/#prerequisites-for-use", "title": "Prerequisites for Use", "text": "<ul> <li>64-bit OS  </li> <li>Java 17  </li> <li>Tomcat 9  </li> </ul>"}, {"location": "extract-connector-sample/#prerequisites-for-development-and-compilation", "title": "Prerequisites for Development and Compilation", "text": "<ul> <li>Java 17  </li> <li>Yarn </li> <li>Extract-interface project (Common interface for using connector and task plugins)  </li> </ul>"}, {"location": "extract-connector-sample/#initializing-the-new-connector-plugin", "title": "Initializing the New Connector Plugin", "text": "<p>The project must be a Java module. The new plugin project must define a dependency on the extract-interface project. Required dependencies are defined in the pom.xml file.  </p> <p>To initialize a new plugin, follow the steps in order: 1. Copy the extract-connector-sample plugin code into a Java workspace. The system will prompt you to define a new name. If it does not, use the context menu (right-click) <code>Refactor &gt; Rename</code>.  </p> <ol> <li> <p>Edit the pom.xml file of the module, replace occurrences of <code>extrat-connector-sample</code> with the new plugin name.    After right-clicking the file, choose <code>Add as Maven Project</code>.  </p> </li> <li> <p>Right-click the namespace <code>ch.asit_asso.extract.connectors.sample</code>, choose the menu <code>Refactor &gt; Rename</code>.    Enter the new class name to identify the plugin. If prompted, click the <code>Add in current Module</code> button to apply the changes only to the module.    This will automatically update the package name in all files of the module.  </p> </li> <li> <p>Right-click the SampleConnector.java file, choose <code>Refactor &gt; Rename</code>, then enter the new main class name of the plugin (e.g., EasySDIv4). This will rename the file and update all references to this class wherever it is used.  </p> </li> <li> <p>Edit the LocalizedMessages.java file: adjust the value of the LOCALIZED_FILE_PATH_FORMAT parameter, which corresponds to the path to the <code>lang</code> directory.  </p> </li> <li> <p>Check the module-info.java file, especially the reference to <code>SampleConnector</code>. Also verify line 4 of this file (reference to the namespace <code>ch.asit_asso.extract.connectors.sample</code>).  </p> </li> <li> <p>Check the file resources\\META-INF\\services\\ch.asit_asso.extract.connectors.common.IConnector, especially the reference to the class <code>ch.asit_asso.extract.connectors.sample.SampleConnector</code>.  </p> </li> <li> <p>Right-click the resources\\connectors\\sample folder, choose <code>Refactor &gt; Rename</code>, and enter the new name.  </p> </li> <li> <p>Edit the file resources\\connectors\\\\lang\\fr\\messages.properties. Modify or add the labels used by the plugin source code. This step can be done progressively during development.   <li> <p>Edit the file resources\\connectors\\\\properties\\config.properties. This file contains the plugin configuration parameters used by the source code. This step can be done progressively during development.   <li> <p>The folder resources\\connectors\\\\templates contains XML templates used by the connector.     However, they are specific to the EasySDIv4 connector, since XML is used as the exchange format for commands. These files will likely not be useful for other types of connectors."}, {"location": "extract-connector-sample/#important-points-to-consider-during-development", "title": "Important Points to Consider During Development", "text": "<p>The source code is sufficiently commented to help the developer build the new plugin. Comments in UPPERCASE identify important code sections or functions that must be updated.  </p> <p>It is recommended to make the following changes in the Connector class:  Adjust the <code>CONFIG_FILE_PATH</code> variable if needed  Change the value of the <code>code</code> parameter to one identifying the plugin (e.g., <code>EasySDIv4</code>)  </p> <p>Next, adapt the functions that override the IConnector interface methods: <code>getParams</code> to define the connector parameters. This method returns plugin parameters as a JSON array. If the plugin does not accept parameters, return an empty array. <code>importCommands</code> to manage importing commands executed by the remote server. * <code>exportResult</code> to manage sending the processing result of a command back to the originating server.  </p> <p>Private functions in the code handle utility operations or process received data. These can be adapted or removed as needed. These functions are clearly identified in the Connector class code.  </p>"}, {"location": "extract-connector-sample/#installing-or-updating-the-plugin-in-extract", "title": "Installing or Updating the Plugin in EXTRACT", "text": "<p>Before compiling the connector, delete the target folder. Once the connector is compiled and the JAR file is generated, place the JAR into the WEB-INF/classes/connectors directory of the application (containing all connector plugins). For updates, delete the WAR of the previous version to avoid conflicts.  </p> <pre><code>Restarting the Tomcat EXTRACT application is then required so that the connector changes are taken into account.\n</code></pre>"}, {"location": "extract-task-sample/", "title": "Extract - Initialize a New Task Plugin", "text": ""}, {"location": "extract-task-sample/#introduction", "title": "Introduction", "text": "<p>This Java module is an example of a task plugin that can be used to initialize a new plugin for the Extract project. The source code is documented and provides the necessary guidance to develop a new plugin. It can be imported into a new Java environment, but adaptations may be required depending on the expected behavior.</p>"}, {"location": "extract-task-sample/#prerequisites-for-use", "title": "Prerequisites for Use", "text": "<ul> <li>64-bit OS  </li> <li>Java 17  </li> <li>Tomcat 9  </li> </ul>"}, {"location": "extract-task-sample/#prerequisites-for-development-and-compilation", "title": "Prerequisites for Development and Compilation", "text": "<ul> <li>Java 17  </li> <li>Yarn </li> <li>Extract-interface project (Common interface for using connector and task plugins)  </li> </ul>"}, {"location": "extract-task-sample/#initializing-the-new-task-plugin", "title": "Initializing the New Task Plugin", "text": "<p>The project must be a Java module. The new plugin project must define a dependency on the extract-interface project. Required dependencies are defined in the pom.xml file.  </p> <p>To initialize a new plugin, follow the steps in order: 1. Copy the extract-task-sample plugin code into a Java workspace. The system will prompt you to define a new name. If it does not, use the context menu (right-click) <code>Refactor &gt; Rename</code>.  </p> <ol> <li> <p>Edit the pom.xml file of the module, replace occurrences of <code>extrat-task-sample</code> with the new plugin name.    After right-clicking the file, choose <code>Add as Maven Project</code>.  </p> </li> <li> <p>Right-click the namespace <code>ch.asit_asso.extract.plugins.sample</code>, choose the menu <code>Refactor &gt; Rename</code>.    Enter the new class name to identify the plugin. If prompted, click the <code>Add in current Module</code> button to apply the changes only to the module.    This will automatically update the package name in all files of the module.  </p> </li> <li> <p>Right-click the SamplePlugin.java file, choose <code>Refactor &gt; Rename</code>, then enter the new main class name of the plugin. This will rename the file and update all references to this class wherever it is used.  </p> </li> <li> <p>Repeat step 4 for the files SampleRequest.java and SampleResult.java.  </p> </li> <li> <p>Edit the LocalizedMessages.java file: adjust the value of the LOCALIZED_FILE_PATH_FORMAT parameter, which corresponds to the path to the <code>lang</code> directory.  </p> </li> <li> <p>Check the module-info.java file, especially the reference to <code>SamplePlugin</code>. Also verify line 4 of this file (reference to the namespace <code>ch.asit_asso.extract.plugins.sample</code>).  </p> </li> <li> <p>Check the file resources\\META-INF\\services\\ch.asit_asso.extract.plugins.common.ITaskProcessor, especially the reference to the class <code>ch.asit_asso.extract.plugins.sample.SamplePlugin</code>.  </p> </li> <li> <p>Right-click the resources\\plugins\\sample folder, choose <code>Refactor &gt; Rename</code>, and enter the new name.  </p> </li> <li> <p>Edit the file resources\\plugins\\\\lang\\fr\\messages.properties. Modify or add the labels used by the plugin source code. This step can be done progressively during development.   <li> <p>Edit the file resources\\plugins\\\\lang\\fr\\help.html to describe the plugin\u2019s functionality. The file content is in HTML format.   <li> <p>Edit the file resources\\plugins\\\\properties\\config.properties. This file contains the plugin configuration parameters used by the source code. This step can be done progressively during development."}, {"location": "extract-task-sample/#important-points-to-consider-during-development", "title": "Important Points to Consider During Development", "text": "<p>The source code is sufficiently commented to help the developer build the new plugin. Comments in UPPERCASE identify important code sections or functions that must be updated.  </p> <p>It is recommended to make the following changes in the Plugin class:  Adjust the <code>CONFIG_FILE_PATH</code> variable if needed  Change the value of the <code>code</code> parameter to one identifying the plugin (e.g., <code>remark</code> or <code>fmeserver</code>) * Change the value of the <code>pictoClass</code> parameter to an appropriate CSS class name (plugin logo image). Search for an icon on the Font Awesome website.  </p> <p>Next, adapt the functions that override the ITaskProcessor interface methods: <code>getParams</code> to define the task plugin parameters. This method returns plugin parameters as a JSON array. If the plugin does not accept parameters, return an empty array. <code>execute</code> to handle the execution of the plugin.  </p>"}, {"location": "extract-task-sample/#installing-or-updating-the-plugin-in-extract", "title": "Installing or Updating the Plugin in EXTRACT", "text": "<p>Before compiling the plugin, delete the target folder. Once the plugin is compiled and the JAR file is generated, place the JAR into the WEB-INF/classes/task_processors directory of the application (containing all task plugins). For updates, delete the WAR of the previous version to avoid conflicts.  </p> <pre><code>Restarting the Tomcat EXTRACT application is then required so that the plugin changes are taken into account.\n</code></pre>"}, {"location": "features/admin-guide/", "title": "Admin guide", "text": ""}, {"location": "features/admin-guide/#user-administration", "title": "User administration", "text": ""}, {"location": "features/admin-guide/#users-list", "title": "Users list", "text": "<p>This page lists all users, whether active or inactive. You can:</p> <ul> <li>create a new user by clicking on the <code>Nouvel utilisateur</code> button</li> <li>manage user groups by clicking on the <code>Groupes</code> button</li> <li>edit a user by clicking on their login</li> <li>delete a user by clicking on the red button with a cross. It is not possible to delete (grayey out button):<ul> <li>Your own account</li> <li>A user directly associated with a process</li> <li>The last active user of a group associated with a process</li> </ul> </li> </ul> <p>It includes a filtering feature based on the following criteria:</p> <ul> <li> <p>Text search (partial and case insensitive) in the following fields:</p> <ul> <li>Login</li> <li>Name</li> <li>Email address</li> </ul> </li> <li> <p>User's role</p> </li> <li>User's state</li> <li>User's notifications status</li> <li>User's 2FA status</li> </ul> <p>The search is executed only when you click the green search button (magnifying glass icon). Alternatively, you can start the search by pressing Enter while focused on a search field.</p>"}, {"location": "features/admin-guide/#user-settings", "title": "User settings", "text": "<p>User's settings are:</p> <ul> <li>User's full name (for display purposes)</li> <li>User's role in the application (operator or administrator). It is not possible to change the role of your own account</li> <li>The username they use to log in (must be unique within the application)</li> <li>Whether the user is active. An inactive user cannot log in to the application. It is not possible to deactivate the account of a user associated with a process.</li> <li>The email address to which notifications concerning them will be sent</li> <li>Whether email notifications are enabled. Only operator-type notifications are affected. Even if notifications are deactivated, the user will continue to receive emails allowing them to reset their password. All notifications for administrators are not affected by this setting.</li> <li>The password they use to log in. If the password is changed, it must follow the password policy.</li> <li>Whether two-factor authentication should be required for the user. In this case, the user will have to register with Google Authenticator (or compatible) the next time they log in, without the option to cancel the registration. If you choose not to require two-factor authentication, the user can still choose to enable it.</li> <li>User language preference (if Extract is in multilingual mode)</li> </ul> <p> Using the buttons at the top of the page, administrators can:</p> <ul> <li>Manage the status of two-factor authentication for the user, i.e. enable it, disable it, or ask the user to register again with a new code. This is a drop-down button that displays a menu when clicked, showing the actions available depending on the user's status</li> <li>In the case of a local user and if LDAP is enabled, the administrator can choose to migrate the user to an LDAP user. The password to be used then becomes the one defined in the company directory. Warning: this operation cannot be reversed.</li> </ul> <p> These operations will result in the loss of any other changes currently in progress.</p> <p>If the user is an LDAP user, the only changes available in Extract are:</p> <ul> <li>Email notifications status</li> <li>Two-factor authentication status (including the option to enforce it or not)</li> <li>User language preference (if Extract is in multilingual mode)</li> </ul>"}, {"location": "features/admin-guide/#users-groups", "title": "Users groups", "text": "<p>User groups allow operators to be grouped together to be assigned to a process as a group. Group settings are accessed from the user list.</p>"}, {"location": "features/admin-guide/#groups-list", "title": "Groups list", "text": "<p>This page lists all users groups with their number of users (active or inactive). Following actions are possible:</p> <ul> <li>Create a new group by clicking on the <code>Nouveau groupe</code> button </li> <li>Edit a group by clicking on its name</li> <li>Delete a group by clicking on the red button with a cross. It is not possible to delete a group associated with a process (grayed out button)</li> </ul>"}, {"location": "features/admin-guide/#groups-settings", "title": "Groups settings", "text": "<p>Group settings are:</p> <ul> <li>Group name (mandatory and unique)</li> <li>The list of users it contains. A user can belong to several groups. For groups associated with a process users can be added or removed, but there must always be at least one active user remaining.</li> </ul>"}, {"location": "features/admin-guide/#processes", "title": "Processes", "text": "<p>A process is a sequence of tasks that generates the data requested by a client.</p>"}, {"location": "features/admin-guide/#processes-list", "title": "Processes list", "text": "<p>This page lists all processes whether or not they are associated with a rule. Following actions are available:</p> <ul> <li>Create a process by clicking on the <code>Nouveau traitement</code> button</li> <li>Edit a process by clicking on its name</li> <li>Duplicate a process by clicking on the green button with a copy icon. An identical copy of the process will be created, including its tasks and settings.</li> <li>Delete a process by clicking on the red button with a cross. Processes associated with a request that is not completed or associated with a connector's rule cannot be deleted (grayed out button).</li> </ul> <p>It includes a filtering feature based on the name of the process. The search is executed only when you click the green search button (magnifying glass icon). Alternatively, you can start the search by pressing Enter while focused on the search field.</p>"}, {"location": "features/admin-guide/#process-details", "title": "Process details", "text": ""}, {"location": "features/admin-guide/#process-parameters", "title": "Process parameters", "text": "<p>At the top of the page, the following are defined:</p> <ul> <li>The name to be given to the process in the application</li> <li>The users or user groups authorized to interact with requests associated with this process. At least one operator or user group must be specified. Administrators can interact with all requests.</li> </ul>"}, {"location": "features/admin-guide/#process-tasks", "title": "Process tasks", "text": "<p>The tasks currently configured for the process are displayed in the order in which they will be executed. You can change the order of the tasks by dragging and dropping the task. Each task can be deleted by clicking on the red button with a cross.</p> <p>Depending on the task type, the following items may be displayed:  </p> <ul> <li>Configuration parameters  </li> <li>A button to display help text</li> </ul> <p>Warning</p> <p>It is strongly recommended not to delete or reorder tasks in a process that has running requests. Result may be unpredictable. However, it is always possible to modify the parameters.</p>"}, {"location": "features/admin-guide/#available-tasks", "title": "Available tasks", "text": "<p>On the right side of the screen is a list of available task with a brief description. To add a task to the process, drag and drop one of these items to the area on the left. If necessary, you can add the same task several times.</p>"}, {"location": "features/admin-guide/#connectors", "title": "Connectors", "text": "<p>Connectors allow you to retrieve requests from a server and send the results back to it.</p>"}, {"location": "features/admin-guide/#connectors-list", "title": "Connectors list", "text": "<p>This page lists all defined connectors, whether active or not. Following actions are available:</p> <ul> <li>Create a new connector by clicking the <code>Nouveau connecteur</code> button, then choosing a server type from the drop-down list</li> <li>Edit a connector by clicking on its name</li> <li>Delete a connector by clicking the red button with the cross. It is not possible to delete a connector with running requests (grayed out button).</li> </ul> <p>It includes a filtering feature based on the name of the process and the connector's type. The search is executed only when you click the green search button (magnifying glass icon). Alternatively, you can start the search by pressing Enter while focused on the search field.</p>"}, {"location": "features/admin-guide/#connector-details", "title": "Connector details", "text": ""}, {"location": "features/admin-guide/#connector-parameters", "title": "Connector parameters", "text": "<p>Generic parameters for all server types are as follows:</p> <ul> <li>The name to give to the connector in the application</li> <li>The number of seconds between two attempts to retrieve requests</li> <li>The number of retries to perform in case of an import problem before setting the connector to error</li> <li>Whether or not to activate the connector. This setting only applies to imports. The result can be exported even when the connector is deactivated.</li> <li>The type of connector to use (non-editable)</li> </ul> <p>In addition, each type of connector can define specific parameters. For easySDI v4 connector, these are:  </p> <ul> <li>The service address used to retrieve requests and return their results</li> <li>The username and password to connect to the service</li> <li>The maximum file size to be exported as a result of the request. Leave this parameter blank for no size limit</li> <li> <p>The URL template for viewing the details of a request on the origin server. This parameter can be left blank, in which case the view link will not be displayed on the request details page. </p> <p>The following variables can be specified between curly brackets. They will be replaced with the properties of the relevant request.</p> Variable Value <code>client</code> Client name who placed the order <code>orderGuid</code> The GUID that identifies the order <code>orderLabel</code> The order number <code>organism</code> The organization of the client who placed the order <code>productGuid</code> The GUID that identifies the product ordered <code>productLabel</code> The name of the product ordered </li> </ul>"}, {"location": "features/admin-guide/#connector-rules", "title": "Connector rules", "text": "<p>Rules allow you to assign a process to a request. Rules are executed from top to bottom. The first active rule whose conditions are met triggers the assigned process, following rules are ignored. Therefore, it's best to place most specific requests first. If no rule matches the request, administrators are notified by email.</p> <p>You can create a new rule by clicking on the <code>Ajouter une r\u00e8gle</code> button and delete one by clicking on the red button with a cross. You can also change the rules order by dragging and dropping them.</p> <p>Following rule parameters are available:</p> <ul> <li>The code defining the rules that link a request to its processing. For details on the required syntax, click the help button in the column header.</li> <li>The process to be associated with the request if the rule matches</li> <li>Whether the rule is active (inactive rules are ignored)</li> </ul> <p>Info</p> <p>The code defining the rules is limited to 65'000 characters by default. It's possible to remove this limitation by changing the type of the rule field in the database (see Rule field size limitation)</p> <p>Info</p> <p>Rule management is not available when creating a connector. You must first save it, then edit it.</p>"}, {"location": "features/admin-guide/#application-settings", "title": "Application settings", "text": ""}, {"location": "features/admin-guide/#orchestration", "title": "Orchestration", "text": "<ul> <li>Storage path : Defines the directory where files generated during request processing are stored. Tomcat user must have both read and write permissions for this directory. Data related to a request are automatically deleted once the request is successfully exported.</li> <li>Show temporary file location to operators : When enabled, the system displays the path of the temporary processing directory on the request details page.</li> <li>Orchestrator update frequency : Specifies the interval (in seconds) between executions of background tasks, such as: request processing, rule matching, data export. Notes :<ul> <li>A lower value makes tasks more responsive but increases server resource usage.</li> <li>It also represents the maximum delay before connector setting changes take effect.</li> <li>This setting does not affect request imports frequency, which are controlled in each connector\u2019s properties (see Connector parameters).</li> </ul> </li> <li>Request list update frequency : Defines how often (in seconds) the home page data is refreshed (see Requests list)</li> <li>Interval between validation reminders : Specifies the number of days between two email reminders sent to operators when a request is still pending validation. Set this value to 0 to disable reminders.</li> </ul>"}, {"location": "features/admin-guide/#operating-hours", "title": "Operating hours", "text": "<p>This section lets you define the time windows during which Extract automatically runs its tasks (import, processing, export, etc.) Regardless of the selected operating mode, you can always log in to the application to perform manual actions such as: Validating requests, modifying processed files, updating application settings, resetting passwords, etc.</p> <p>You can define operating time slots by clicking on the <code>Ajouter une plage</code> button. The days and times indicated are included in the time slot. If several time slots are defined, automatic tasks will run whenever at least one slot covers the current day and time. You can also delete a time slot by clicking the red Delete button next to it.</p> <p>Time slots can be defined at any time, but they are only applied if the operating mode <code>Seulement durant les heures ci-dessous</code> is selected. If this mode is chosen but no slot is defined, the system behaves the same as in <code>Arr\u00eat complet</code> mode.</p>"}, {"location": "features/admin-guide/#smtp-server", "title": "SMTP server", "text": "<p>This section covers the configuration of server settings for email notifications.</p> <ul> <li>SMTP User: Used to authenticate with the SMTP server.</li> <li>Sender Details: You can specify both the sender\u2019s name and email address. Depending on the server\u2019s policy, these may differ.</li> </ul>"}, {"location": "features/admin-guide/#ldap-authentication", "title": "LDAP authentication", "text": "<p>This section lets you enable and configure LDAP login using your corporate directory. You can specify:</p> <ul> <li>LDAP servers: Enter the server name(s) and port(s) (optional). If multiple servers are used, separate them with semicolons.</li> <li>Encryption type: Choose the security protocol for connections.</li> <li>Domain or base DNs: For Active Directory, enter the domain. For other LDAP servers, provide one or more base DNs (separated by semicolons).</li> <li>Group DN: Define the DN of the group whose members will be assigned roles in Extract.<ul> <li>Members of the operator group will be assigned the Operator role.</li> <li>Members of the administrator group will be assigned the Administrator role.</li> <li>If a user belongs to both groups, they will be considered an Administrator.</li> </ul> </li> </ul>"}, {"location": "features/admin-guide/#synchronization-with-ldap", "title": "Synchronization with LDAP", "text": "<p>Extract can automatically run a task to keep LDAP users and their attributes up to date. To enable synchronization, you\u2019ll need to provide the username and password of an LDAP account with read permissions and the synchronization interval (in hours).</p> <p>During each synchronization, Extract will:</p> <ul> <li>Deactivate users who are no longer present in the directory or who have been disabled (in the case of Active Directory)</li> <li>Update existing LDAP users\u2019 email addresses, full names, and roles if they have changed</li> <li>Create new Extract accounts for users who belong to an LDAP administrator or operator group but do not yet exist in Extract</li> </ul> <p>You can start synchronization immediately (in the background) by clicking the <code>Synchroniser maintenant</code> button. Otherwise, synchronization is performed using the settings saved in the database. Please save your settings beforehand if you have modified them.</p> <p>Info</p> <p>If a user is disabled or deleted in the LDAP directory, they will no longer be able to connect to Extract, even if synchronization has not been performed.</p>"}, {"location": "features/admin-guide/#ldap-connection-test", "title": "LDAP connection test", "text": "<p>The <code>Tester la connexion</code> button lets you verify whether the current settings can successfully establish a connection. The test runs with the values you\u2019ve entered, even if they haven\u2019t been saved yet.</p> <ul> <li>If synchronization is enabled, the test uses the provided username and password.</li> <li>If synchronization is disabled, the test runs anonymously.</li> </ul>"}, {"location": "features/admin-guide/#request-validation", "title": "Request validation", "text": "<p>This section lets you specify which request properties should be highlighted for operators in the request validation area (see Validation in the user guide). No syntax checks is applied to the properties entered here \u2014 only properties that actually exists in the request will be considered.</p> <p>Additionally, this section provides access (by clicking on the <code>G\u00e9rer les mod\u00e8les</code> button) to the management of predefined comment templates used during request validation steps.</p>"}, {"location": "features/admin-guide/#validation-comment-templates-list", "title": "Validation comment templates list", "text": "<p>This page lists all existing message templates. Following action are available:</p> <ul> <li>Create a new validation message by clicking on the <code>Nouveau message</code> button</li> <li>Edit a message by clicking on its title</li> <li>Delete a message by clicking on the red button with a cross. It is not possible to delete a message associated with a validation task of a process (grayed out button).</li> </ul>"}, {"location": "features/admin-guide/#validation-comment-template-details", "title": "Validation comment template details", "text": "<p>Message parameters are:</p> <ul> <li>Its title (for display in the validation plugin settings and in the list of comments available during validation)</li> <li>Message text. The strings <code>[operatorName]</code> and <code>[operatorEmail]</code> will be replaced by the name and email address of the operator who validated the process.</li> </ul>"}, {"location": "features/admin-guide/#miscellaneous-information", "title": "Miscellaneous information", "text": "<p>This section provides general information about Extract, including the application version installed.</p> <p> </p>"}, {"location": "features/architecture/", "title": "Application architecture", "text": ""}, {"location": "features/architecture/#foreword", "title": "Foreword", "text": "<p>This document is the technical architecture file for the Extract project. It contains the structural elements of the project, such as the general architecture, data flows, interfaces, and data model. It is primarily intended for:</p> <ul> <li>The IT project manager</li> <li>The project architects</li> <li>The production team</li> <li>The maintenance team*</li> </ul>"}, {"location": "features/architecture/#general-architecture", "title": "General architecture", "text": ""}, {"location": "features/architecture/#basic-logic-diagram", "title": "Basic logic diagram", "text": "<p>The following logical diagram illustrates the principle of a configurable process.</p> <p></p> <ol> <li>The import is performed by the application for each declared and active connector.</li> <li>For each request element, the application applies the dispatch rules that define which process should be launched.</li> <li>Within each process, the pre-configured tasks are executed. Each process runs independently. The tasks in a process may include the following: adding a comment, validation, extraction, archiving.</li> <li>The export is performed for each request element by the connector that imported it.</li> </ol>"}, {"location": "features/architecture/#software-architecture-diagram", "title": "Software architecture diagram", "text": "<p>The proposed solution is based on a modular and scalable architecture. The various functional components are illustrated in the diagram below.</p> <p></p>"}, {"location": "features/architecture/#flows-description", "title": "Flows description", "text": "<p>The solution consists of a single server, so no specific flow needs to be set up other than HTTP(S) access to this server (port 80 or 443).</p>"}, {"location": "features/architecture/#data-description", "title": "Data description", "text": ""}, {"location": "features/architecture/#database-schema", "title": "Database schema", "text": "<p>A single database and a single schema are created, and the user who owns the schema is used for all connections from the implemented solution (read/write).</p>"}, {"location": "features/architecture/#conceptual-data-model", "title": "Conceptual data model", "text": ""}, {"location": "features/architecture/#data-tables-description", "title": "Data tables description", "text": ""}, {"location": "features/architecture/#connectors", "title": "CONNECTORS", "text": "<p>Table listing the connectors configured in the system. It is not possible to modify/delete a connector if a related request is incomplete. Deleting a connector involves deleting the associated rules and setting the id_connector of the related requests in the REQUESTS table to null.</p> Attribute Type Description Example <code>id_connector</code> int Primary key 1 <code>connector_code</code> varchar 50 Code identifying the connector type. Retrieved from the connector itself via a specific function. The code must be unique in the connector catalog. easysdiv4 <code>connector_label</code> varchar 255 Connector label. Retrieved from the connector itself via a specific function. EasySdi V4 <code>connector_params</code> varchar 4000 Connector-specific parameters in JSON format. The list of parameters and their types are retrieved from the connector itself via a specific function. cf 4.1 <code>name</code> varchar 50 Name given to the connector instance asitvd_dev <code>import_freq</code> int Frequency of connector queries when active 60 <code>active</code> boolean Defines whether the connector is active or not true <code>last_import_msg</code> varchar 4000 Last message returned by the connector import Success <code>last_import_date</code> datetime Date and time of the last import 16/11/2016 21:15"}, {"location": "features/architecture/#rules", "title": "RULES", "text": "<p>Table listing the rules applied to a given connector and associating a process with each of them.</p> Attribute Type Description Example <code>id_rule</code> int Primary key 1 <code>id_process</code> int Foreign key linking to the PROCESSES table 1 <code>id_connector</code> int Foreign key linking to the CONNECTORS table 1 <code>rule</code> varchar 4000 Definition of the rule according to the system's specific syntax prod_code == \u201811\u2019 <code>active</code> boolean Defines whether the rule is active or not true <code>position</code> int Scheduling of rules for the same connector 5"}, {"location": "features/architecture/#processes", "title": "PROCESSES", "text": "<p>Table listing the processes configured in the system. It is not possible to modify (i.e., the tasks that comprise it) a process if a related request is ONGOING. It is not possible to delete a process if a related request is incomplete or if it is associated with a connector rule.</p> Attribute Type Description Example <code>id_process</code> int Primary key 1 <code>name</code> varchar 255 Process title R\u00e9seau de Gaz"}, {"location": "features/architecture/#tasks", "title": "TASKS", "text": "<p>Table listing the tasks (plugins) configured for a given process.</p> Attribute Type Description Example <code>id_task</code> int Primary key 1 <code>id_process</code> int Foreign key linking to the PROCESSES table 1 <code>task_code</code> varchar 50 Code identifying the task plugin type. Retrieved from the plugin itself via a specific function. The code must be unique in the connector catalog FME2016 <code>task_label</code> varchar 255 Task plugin label. Retrieved from the plugin itself via a specific function Extraction FME 2016 <code>task_params</code> varchar 4000 Parameters specific to the task plugin in json format. The list of parameters and their type are retrieved from the plugin itself via a specific function cf 0 <code>position</code> int Scheduling of tasks between each other for the same process 3"}, {"location": "features/architecture/#processes_users", "title": "PROCESSES_USERS", "text": "<p>Table ensuring the assignment of one or more users to a given process.</p> Attribute Type Description Example <code>id_process</code> int Foreign key linking to the PROCESSES table 1 <code>id_user</code> int Foreign key linking to the USERS table 1"}, {"location": "features/architecture/#processes_usergroups", "title": "PROCESSES_USERGROUPS", "text": "<p>Table ensuring the assignment of one or more groups to a given process.</p> Attribute Type Description Example <code>id_process</code> int Foreign key linking to the PROCESSES table 1 <code>id_usergroup</code> int Foreign key linking to the USERGROUPS table 1"}, {"location": "features/architecture/#users", "title": "USERS", "text": "<p>User table. It is not possible to delete a user if they are associated with a process. When a user is deleted, the items linked to them in the REQUEST_HISTORY table are assigned an <code>id_user</code> value of <code>null</code>, indicating that the user is now unknown.</p> Attribute Type Description Example <code>id_user</code> int Primary key 1 <code>user_type</code> string User type: LOCAL: user whose Extract database is the authentication source. LDAP: user whose LDAP server is the authentication source LOCAL <code>two_factor_status</code> string 2FA status: ACTIVE / INACTIVE / STANDBY ACTIVE <code>two_factor_forced</code> varchar 100 2FA imposed by the administrator ? true <code>two_factor_token</code> varchar 100 String used to generate two-factor authentication codes (encrypted) Xxxxx <code>two_factor_standby_token</code> string String used to generate two-factor authentication codes (encrypted) awaiting validation by the user Xxxxx <code>profile</code> string Attribute that can take two values. ADMIN: Administrator. OPERATOR: Operator. Note: the texts corresponding to the values are managed in the application itself to ensure multilingual support. ADMIN <code>name</code> varchar 50 Full name of the user Xxxx <code>login</code> varchar 50 User login Xxxx <code>pass</code> varchar 60 User password * <code>email</code> varchar 50 User email example@myentreprise.ch <code>active</code> boolean Defines whether the user is active or not true <code>mailactive</code> boolean Defines whether notifications are active for the user true <code>tokenpass</code> varchar 50 Token used for password recovery (single use). Attribute reset to null when the user next logs in (regardless of the password used) so37dd9sxwxdx3449ckl <code>tokenexpire</code> datetime Foreign key linking to the USERGROUPS table. Token expiration date/time 2016.01.01 12 :00"}, {"location": "features/architecture/#recovery_codes", "title": "RECOVERY_CODES", "text": "<p>Table of recovery codes per user in case of loss of access to the device enabling two-factor authentication. When a code is successfully used, it is removed from this table.</p> Attribute Type Description Example <code>id_code</code> int Primary key 1 <code>Id_user</code> int Foreign key linking to the USERS table 1 <code>token</code> varchar 100 Recovery code (hashed) Xxxxx"}, {"location": "features/architecture/#remember_me_tokens", "title": "REMEMBER_ME_TOKENS", "text": "<p>Table tracking tokens issued so that two-factor authentication is not required for a user on a machine for a certain period of time.</p> Attribute Type Description Example <code>id_code</code> int Primary key 1 <code>Id_user</code> int Foreign key linking to the USERS table 1 <code>token</code> varchar 100 Random string contained in the authorization cookie Xxxxxx <code>tokenexpire</code> timestamp Date and time of authorization expiration 154564566"}, {"location": "features/architecture/#requests", "title": "REQUESTS", "text": "<p>Table listing current and completed requests.</p> <p>In order to manage connectors with multiple interfaces, the connector itself must provide the request elements in a standardized format for database entry. This format consists of p_xxx attributes.</p> Attribute Type Description Example <code>id_request</code> int Primary key 1 <code>id_process</code> int Foreign key linking to the PROCESSES table. This parameter remains null if no rule matches the query element. 1 <code>id_connector</code> int Foreign key linking to the CONNECTORS table.  This parameter is null if the associated connector has been deleted 1 <code>p_orderlabel</code> varchar 255 Standardized query parameter  Order name 123456 / 6 <code>p_orderguid</code> varchar 255 Standardized query parameter  Order ID, also to be provided when sending the result 677587e2-057f-0144-ddc1-9feca766448f <code>p_productguid</code> varchar 255 Standardized query parameter  ID of the product ordered, also to be provided when sending the result 708e932b-81c3-2ce4-b907-ed07e61ac5f9 <code>p_productlabel</code> varchar 255 Standardized query parameter  Name of the product ordered Plan du r\u00e9seau d\u2019eau commune de Bex <code>p_organism</code> varchar 255 Standardized query parameter  Organization receiving the order Terrassements SA <code>p_client</code> varchar 255 Standardized query parameter  Customer receiving the order Terrassements SA <code>p_clientguid</code> varchar 255 Standardized query parameter  Customer ID 708e932b-81c3-2ce4-b907-ed07e61ac5f9 <code>p_organismguid</code> varchar 255 Standardized query parameter  Organization ID 708e932b-81c3-2ce4-b907-ed07e61ac5f9 <code>p_tiers</code> varchar 255 Standardized query parameter  Third party linked to the order Commune de Bex <code>p_tiersguid</code> varchar 255 Standardized query parameter  GUID of the third party linked to the order 708e932b-81c3-2ce4-b907-ed07e61ac5f9 <code>p_clientdetails</code> varchar 4000 Standardized query parameter  Details of the customer receiving the order Nom de rue 371880 BexTel :00.00.00.00.00Mail : xxx@yyy.com <code>p_tiersdetails</code> varchar 4000 Standardized query parameter  Details of the third party linked to the order Nom de rue 371880 BexTel :00.00.00.00.00Mail : xxx@yyy.com <code>p_perimeter</code> varchar 4000 Standardized query parameter  Coordinates of the extraction polygon POLYGON((6.9378 46.1056,6.1245 \u2026 <code>p_surface</code> float Standardized query parameter  Extraction polygon area 123.4 (m2) <code>p_parameters</code> varchar 4000 Standardized query parameter  List of non-standardized parameters passed as is to task plugins {\u2018format\u2019 :\u2019pdf\u2019, \u2026 } <code>p_external_url</code> varchar 255 URL for accessing order details on the origin server https://viageo.ch/commandes/123456 <code>remark</code> varchar 4000 Any comments related to the query element. Modifiable by task plugins Donn\u00e9e fournie \u00e0 titre confidentielle <code>folder_in</code> varchar 255 Request element input directory. Defined by the application based on a base path (configurable by the administrator). It is sent to task plugins along with the other parameters of the request element /677587e2-057f-0144-ddc1-9feca766448f/20161212180000/in <code>folder_out</code> varchar 255 Output directory of the request element. Defined by the application based on a base path (configurable by the administrator). It is sent to the task plugins along with the other request element parameters. /677587e2-057f-0144-ddc1-9feca766448f/20161212180000/out <code>start_date</code> datetime Date and time the query was created in the system. 22.11.2016 09:00 <code>end_date</code> datetime Date and time the query processing ended. 22.11.2016 09:15 <code>tasknum</code> int Number of the task currently in progress in the process. <code>rejected</code> boolean False by default.  Flag indicating that the operator or administrator wanted to stop the associated processing and thus reject the request. False <code>status</code> string Status of the request in its lifecycle.IMPORTED: Imported \u2013 The request is initialized in the system following a connector import (or when the status is forced by the administrator)IMPORTFAIL: Import failure \u2013 The request cannot be processed because its import via the connector failedONGOING: In progress \u2013 A rule has allowed the request to be associated with a process. The orchestrator can move it forward.STANDBY: On hold \u2013 Manual action is required on the current task (e.g., validation plugin).ERROR: Error \u2013 The current task has encountered an error (e.g., FME script not found).UNMATCHED: Unmatched \u2013 No rule has allowed a process to be associated with the requestTOEXPORT: To be exported \u2013 The last task in a process has been completed successfully. The request is ready for exportEXPORTFAIL: Export failure \u2013 The request has been processed but its export via its original connector has failedFINISHED: Finished \u2013 The request has been processed and the export was successfulNote: the texts corresponding to the values are managed in the application itself in order to ensure multilingual support. IMPORTED <code>last_reminder</code> datetime Date and time of the last reminder in the case of a request awaiting validation 22.11.2016 09:00"}, {"location": "features/architecture/#request_history", "title": "REQUEST_HISTORY", "text": "<p>Table listing the processing history for each of the requests initiated. For a given request, there may be more items in this table than tasks, since the user can go back in the processing. This table must remain completely independent of the process (and therefore the tasks) attached to the request. This is to avoid corrupting the history if the process is modified retrospectively. All history items must therefore be duplicated in this table (e.g., task_label).</p> Attribute Type Description Example <code>Id_record</code> int Primary key 1 <code>id_request</code> int Foreign key linking to the PROCESSES table 1 <code>id_user</code> int Foreign key linking to the USERS table. 0 = systemnull = unknown (user deleted)Note: the texts corresponding to the values are managed in the application itself in order to ensure multilingual support. 1 <code>task_label</code> varchar 255 Label of the corresponding task plugin or Export for the export step or Import for the import step Extraction FME 2016 <code>status</code> string Task status ONGOING: In progress - The task is being processedSTANDBY: Waiting - Manual action is required (e.g. validation plugin)ERROR: Error - The task has encountered an error (e.g. FME script not found) or the import/export has failedFINISHED: Finished - The task/import/export has been successfully completedNote: the texts corresponding to the values are managed in the application itself in order to ensure multilingual support. FINISHED <code>last_msg</code> varchar 4000 Last message returned by the plugin (error message or success message) or by the connector (import/export step). Incremented by 1 with each new entry in this table (for the same id_request) <code>step</code> int Standardized query parameter  Name of the product ordered 3 <code>start_date</code> datetime Date and time when task processing began 22.11.2016 09:00 <code>end_date</code> datetime Date and time when task processing endedNull if the task plugin is currently running. 22.11.2016 09:02 <code>process_step</code> int Task number in the process 1"}, {"location": "features/architecture/#system", "title": "SYSTEM", "text": "<p>Table listing the system parameters required for the solution to function properly.</p> Attribute Type Description Example <code>key</code> varchar 50 Primary key smtp_port <code>value</code> varchar 65000 System attribute value 25 <p>Below is a list of the keys contained in this table. These keys cannot be modified.</p> Key Value (example or domains) <code>freq_scheduler_sec</code> 1 <code>dashboard_interval</code> 10 <code>smtp_server</code> mail.laboite.ch <code>smtp_port</code> 25 <code>smtp_from_name</code> EX3K <code>smtp_from_mail</code> ex3k.noreply@laboite.ch <code>smtp_pass</code> ** <code>smtp_user</code> admin <code>smtp_ssl</code> 0 <code>base_path</code> D:\\extract\\orders <code>display_temp_folder</code> false <code>mails_enable</code> true <code>op_mode</code> ON / RANGES / OFF <code>op_timeranges</code> [\u2003{dayfrom :1, dayto :4, timefrom :7, timeto :18},\u2003{dayfrom :5, dayto :5, timefrom :7, timeto :16},\u2003{\u2026}] <code>ldap_on</code> true <code>ldap_servers</code> ldap.example.com, ldap2.example.com <code>ldap_encryption_type</code> LDAPS / STARTTLS <code>ldap_base_dn</code> *cn=admin,dc=example,dc=com * <code>ldap_admins_group</code> CN=YourGroup, OU=Users,DC=YourDomain,DC=COM <code>ldap_operators_group</code> CN=YourGroup, OU=Users,DC=YourDomain,DC=COM <code>ldap_synchro_on</code> true <code>ldap_user</code> Service_account_extract <code>ldap_password</code> xxxxx <code>ldap_synchro_freq</code> 24 <code>ldap_last_synchro</code> 22.11.2016 09:00 <code>standby_reminder_days</code> 3 <code>validation_focus_properties</code> REMARK, PROJECTION, FORMAT"}, {"location": "features/architecture/#remarks", "title": "REMARKS", "text": "<p>Table listing predefined messages to be used as comments during the validation stage of a process.</p> Attribute Type Description Example <code>Id_remark</code> int Primary key 1 <code>content</code> varchar 65000 Comment text Madame, Monsieur, Votre commande... <code>title</code> varchar 255 Comment title (for display in the list) P\u00e9rim\u00e8tre non valide"}, {"location": "features/architecture/#usergroups", "title": "USERGROUPS", "text": "<p>Table listing user groups that can be assigned to a process</p> Attribute Type Description Example <code>Id_usergroup</code> int Primary key 1 <code>name</code> varchar  50 User group name Responsables cadastre"}, {"location": "features/architecture/#users_usergroups", "title": "USERS_USERGROUPS", "text": "<p>Table ensuring that users belong to user groups</p> Attribute Type Description Example <code>Id_usergroup</code> int Foreign key linking to the USERGROUPS table 1 <code>Id_user</code> int Foreign key linking to the USERS table 1"}, {"location": "features/architecture/#deletion-of-database-elements", "title": "Deletion of database elements", "text": "<p>The table below shows the constraints and triggers established directly in the database for managing cascading deletions.</p> <p>Note: these actions/deletions do not need to be managed in the web interface.</p> Source element Target element Deletion/cascading action <code>CONNECTORS</code> <code>RULES</code> Deleting items in the RULES linked tableNote: however, this scenario is only possible for connectors without unfinished linked requests. The interface must not allow a connector to be deleted if it has an ongoing or pending request associated with it. <code>CONNECTORS</code> <code>REQUESTS</code> Setting the id_connector in the REQUESTS table to nullNote: however, this scenario is only possible for connectors without unfinished linked requests. The interface must not allow a connector to be deleted if it has a request in progress or pending. <code>REQUESTS</code> <code>REQUEST_HISTORY</code> Deleting items in the linked REQUEST_HISTORY table. <code>PROCESSES</code> <code>REQUESTS</code> Setting the id_process in the REQUESTS table to nullNote: however, this scenario is only possible for completed requests. The interface must not allow a process to be deleted if it has a pending or ongoing request associated with it. <code>PROCESSES</code> <code>RULES</code> Delete items in the linked RULES tableNote: however, this scenario should never occur, as the interface must not allow a process to be deleted if it has a rule associated with it <code>PROCESSES</code> <code>TASKS</code> Deleting items in the TASKS related table <code>PROCESSES</code> <code>PROCESSES_USERS</code> Deleting items in the PROCESSES_USERS related table <code>PROCESSES</code> <code>PROCESSES_USERGROUPS</code> Deleting items in the PROCESSES_USERGROUPS related table <code>USERS</code> <code>REQUEST_HISTORY</code> Setting the id_user in the REQUEST_HISTORY table to null <code>USERS</code> <code>PROCESSES_USERS</code> Deleting items in the PROCESSES_USERS related table <code>USERS</code> <code>USER_USERGROUPS</code> Deleting items in the USER_USERGROUPS related table <code>USERS</code> <code>RECOVERY_CODES</code> Delete items in the RECOVERY_CODES related table <code>USERS</code> <code>REMEMBER_ME_TOKENS</code> Delete items in the REMEMBER_ME_TOKENS related table <code>USERGROUPS</code> <code>PROCESSES_USERGROUPS</code> Delete items in the PROCESSES_USERGROUPS related table <code>USERGROUPS</code> <code>USER_USERGROUPS</code> Delete items in the USER_USERGROUPS related table"}, {"location": "features/architecture/#request-lifecycle", "title": "Request lifecycle", "text": "<p>Requests follow the lifecycle illustrated in the diagram below. Transitions show the system or user event that triggered them.</p> <p></p>"}, {"location": "features/architecture/#description-of-interfaces-and-third-party-systems", "title": "Description of interfaces and third-party systems", "text": ""}, {"location": "features/architecture/#connector-catalog", "title": "Connector catalog", "text": ""}, {"location": "features/architecture/#introduction", "title": "Introduction", "text": "<p>The connector catalog contains all connectors available for the system. They must all implement the following interface functions:</p> <ul> <li><code>String getCode</code>: returns the connector code, which must be unique in the catalog</li> <li><code>String getLabel</code>: returns the connector name</li> <li><code>String getDescription</code>: returns formatted text describing the connector</li> <li><code>String getHelp</code>: returns formatted text to guide the user in entering parameters</li> <li><code>String getParams</code>: returns the parameters specific to the connector, in json format. Each parameter is defined by a unique code, a label, a type, whether it is mandatory or not, and any other tags specific to the type. The types available for connectors are as follows:<ul> <li>text : character string to be entered via a text box. The maximum length of the string is specified in an additional attribute.</li> <li>pass: character string to be entered via a hidden text field. The maximum length of the string is specified in an additional attribute.</li> </ul> </li> <li><code>Object new(params)</code>: creates an instance of the connector by passing the user-defined parameters. Returns the created object.</li> <li><code>Object importCommands()</code>: launches the command import. Returns an object consisting of an error code, the list of request elements in standardized format, and, if applicable, an associated message.</li> <li><code>Object exportResults(request)</code>: launches the export of a command result. The request element (containing in particular the output directory, the remark attribute, the status, etc.) is passed as a parameter (complete object from the REQUESTS table). Returns an error code and, if applicable, an associated message.</li> </ul> <p>The following chapters list the return values of these functions for each of the connectors available in the first version of the solution. Note that plugins must implement multilingual support in the return values of functions. The descriptions below correspond to the English version.</p>"}, {"location": "features/architecture/#easy-sdi-v4-connector", "title": "Easy SDI v4 connector", "text": "Function Return <code>getCode</code> easysdiv4 <code>getLabel</code> EasySdi V4 <code>getDescription</code> Connecteur pour la solution EasySdi V4 <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018url\u2019, \u2018label\u2019 : \u2018URL du service\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018login\u2019, \u2018label\u2019 : \u2018Login distant\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 50},\u2003{\u2018code\u2019 : \u2018pass\u2019, \u2018label\u2019 : \u2018Mot de passe\u2019, \u2018type\u2019 : \u2018pass\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 50}]Below is an example of the corresponding settings (connector_params attribute in the CONNECTOR table):{\u2003 \u2018url\u2019 : \u2018http://www.asitvd.ch/extractpoint/rest\u2019,\u2003 \u2018login\u2019 : \u2018fournisseur12445\u2019,\u2003 \u2018pass\u2019 : \u2018motdepasse\u2019}"}, {"location": "features/architecture/#task-plugin-catalog", "title": "Task Plugin Catalog", "text": ""}, {"location": "features/architecture/#introduction_1", "title": "Introduction", "text": "<p>The task catalog contains all of the task plugins available for the system. They must all implement the following interface functions:</p> <ul> <li><code>String getCode</code>: returns the plugin code, which must be unique in the catalog.</li> <li><code>String getLabel</code>: returns the task plugin name.</li> <li><code>String getDescription</code>: returns formatted text describing the plugin </li> <li><code>String getHelp</code>: returns formatted text to guide the user in entering parameters</li> <li><code>String getPictoClass</code>: returns the class to be used for the plugin pictogram</li> <li><code>String getParams</code>: returns the parameters specific to the task plugin, in json format. Each parameter is defined by a unique code, a label, a type, whether it is mandatory or not, and any other tags specific to the type. The types available for task plugins are as follows:<ul> <li>text: character string to be entered via a text box. The maximum length of the string is specified in an additional attribute. </li> <li>multitext: character string to be entered via a multi-line text box. The maximum length of the string is specified in an additional attribute. Parameters of this type support    dynamic strings using the same keywords as the text type.</li> <li>pass: character string to be entered via an obfuscated text field. The maximum length of the string is specified in an additional attribute.</li> <li>list: list of choices to be entered via a drop-down list. The available options are specified in an additional attribute (values separated by |)</li> <li>boolean: boolean to be entered via a checkbox</li> <li>email: email address or list of email addresses separated by a semicolon and/or a comma.</li> <li>list_msgs (for new validation plugin): multiple choice list filled in by the Extract core with the validation messages defined at the Extract instance level.</li> <li>numeric (for FME Desktop plugin): Numeric value. Min, max, and step are specified in three additional attributes.</li> </ul> </li> <li><code>Object new(params)</code>: creates an instance of the plugin by passing the user-defined parameters. Returns the created object.</li> <li><code>Object execute(request)</code>: executes the task plugin according to the request element passed as parameters. Returns an object of the type:<ul> <li>State: status among success, error, standby</li> <li>Code: if applicable, return code </li> <li>Message: message associated with the state (stored in last_msg for info). This can be a raw message from a tool underlying the plugin (e.g. FME), an informative message explaining why the plugin is on standby, etc.</li> <li>Request: request element passed as input and possibly modified by the plugin</li> </ul> </li> </ul> <p>The following chapters list the return values of these functions for each of the plugins available in the first version of the solution. Note that plugins must implement multilingual support in the return values of functions (except, of course, for error/success messages from underlying tools). The descriptions below correspond to the English version.</p>"}, {"location": "features/architecture/#file-archiving-plugin", "title": "File Archiving Plugin", "text": "Function Return <code>getCode</code> ARCHIVE <code>getLabel</code> Archivage fichiers <code>getDescription</code> Copie des fichiers dans un r\u00e9pertoire local ou r\u00e9seau <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018path\u2019, \u2018label\u2019 : \u2018Chemin d\u2019archivage\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018login\u2019, \u2018label\u2019 : \u2018Login\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018pass\u2019, \u2018label\u2019 : \u2018Mot de passe\u2019, \u2018type\u2019 : \u2018pass\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 255},]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003 \u2018path\u2019 : \u2018/var/extraction/{no_commande}-{date}/{code-produit}/\u2019} <p>Note: This plugin supports dynamic strings in its settings according to the following keywords:</p> <ul> <li>{orderLabel}</li> <li>{orderGuid}</li> <li>{productGuid}</li> <li>{productLabel}</li> <li>{startDate}</li> <li>{organism}</li> <li>{client}</li> </ul>"}, {"location": "features/architecture/#fme-2016-extraction-plugin", "title": "FME 2016 Extraction Plugin", "text": "Function Return <code>getCode</code> FME2016 <code>getLabel</code> Extraction FME 2016 <code>getDescription</code> Workbench ou script FME Desktop 2016 <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018path\u2019, \u2018label\u2019 : \u2018Chemin du fichier workbench\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018pathFME\u2019, \u2018label\u2019 : \u2018Chemin du programme FME\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018instances\u2019, \u2018label\u2019 : \u2018Nombre de fme.exe lanc\u00e9s par ce workspace\u2019, \u2018type\u2019 : \u2018numeric\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018min\u2019 : 1, \u2018step\u2019 : 1, \u2018max : 8}]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003\u2018path\u2019 : \u2018/var/FME/exports_scripts/gaz_prod.fmw\u2019,\u2003\u2018pathFME\u2019: \u2018/usr/share/fme-destop-2016/fme\u2019,\u2003\u2018instances\u2019: 3} <p>Please note that for the FME 2016 plugin to work properly, the scripts used must expose the following parameters:</p> <ul> <li>opt_responseformat: FME parameter, managed internally by the plugin because it expects a return in json (html by default)</li> <li> <p>Perimeter: perimeter in WKT format, in WGS84, provided by the import connector. For example: POLYGON((6.295363612819898 46.32659377501397,6.288481575413728 46.65130021757865,7.055293317619941 46. 656470518789625,7.057591178865101 46.33173342736276,6.295363612819898 46.32659377501397))</p> </li> <li> <p>Parameters: dynamic parameters provided in JSON format by the import connector. For example:</p> </li> <li>Product: GUID of the product to be exported, provided by the import connector. For example: a049fecb-30d9-9124-ed41-068b566a0855</li> </ul>"}, {"location": "features/architecture/#fme-server-extraction-plugin", "title": "FME Server Extraction Plugin", "text": "Function Return <code>getCode</code> FMESERVER <code>getLabel</code> Extraction FME Server <code>getDescription</code> Job FME Server API 1.2 <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018url\u2019, \u2018label\u2019 : \u2018Url du service\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018login\u2019, \u2018label\u2019 : \u2018Login distant\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 50},\u2003{\u2018code\u2019 : \u2018pass\u2019, \u2018label\u2019 : \u2018Mot de passe\u2019, \u2018type\u2019 : \u2018pass\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 50}]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003\u2018url\u2019 : \u2018http://localhost/FME/exports_scripts/gaz_prod\u2019,\u2003\u2018login\u2019 : \u2018admin\u2019,\u2003\u2018pass\u2019 : \u2018password01\u2019} <p>Please note that for the FME Server plugin to work properly, the scripts used must expose the following parameters:</p> <ul> <li>opt_responseformat: FME parameter, managed internally by the plugin because it expects a return in json (html by default)</li> <li> <p>Perimeter: perimeter in WKT format, in WGS84, provided by the import connector. For example: POLYGON((6.295363612819898 46.32659377501397,6.288481575413728 46.65130021757865,7.055293317619941 46. 656470518789625,7.057591178865101 46.33173342736276,6.295363612819898 46.32659377501397))</p> </li> <li> <p>Parameters: dynamic parameters provided in JSON format by the import connector. For example:</p> </li> <li>Product: GUID of the product to be exported, provided by the import connector. For example: a049fecb-30d9-9124-ed41-068b566a0855</li> </ul>"}, {"location": "features/architecture/#fixed-remark-plugin", "title": "Fixed remark plugin", "text": "Function Return <code>getCode</code> REMARK <code>getLabel</code> Remarque fixe <code>getDescription</code> Ajoute une remarque pr\u00e9-d\u00e9finie \u00e0 l\u2019\u00e9l\u00e9ment de requ\u00eate <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018remark\u2019, \u2018label\u2019 : \u2018Remarque\u2019, \u2018type\u2019 : \u2018multitext\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 5000},\u2003{\u2018code\u2019 : \u2018overwrite\u2019, \u2018label\u2019 : \u2018Ecraser la remarque existante\u2019, \u2018type\u2019 : \u2018boolean\u2019}]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003\u2018remark\u2019 : \u2018Les positions exactes des conduits doivent \u00eatre v\u00e9rifi\u00e9es par sondage.\\nVoir nos conditions sur http://laboite.ch/exploitation\u2019,\u2003\u2018overwrite\u2019 : true}"}, {"location": "features/architecture/#operator-validation-plugin", "title": "Operator validation plugin", "text": "Function Return <code>getCode</code> VALIDATION <code>getLabel</code> Validation op\u00e9rateur <code>getDescription</code> Demande \u00e0 un op\u00e9rateur de valider l\u2019\u00e9l\u00e9ment <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2019code\u2019: \u2018valid_msgs\u2019, \u2018label\u2019: \u2018Mod\u00e8les de remarque pour la validation\u2019, \u2018type\u2019 : \u2018list_msgs\u2019, \u2018req\u2019 : false},\u2003{\u2019code\u2019: \u2018reject_msgs\u2019, \u2018label\u2019: \u2018Mod\u00e8les de remarque pour l\u2019annulation\u2019, \u2018type\u2019 : \u2018list_msgs\u2019, \u2018req\u2019 : false}]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003\u2018valid_msgs : \u2018312,313,314\u2019,\u2003\u2018reject_msgs\u2019 : \u2018313,315\u2019}Note: validation must be performed by one of the operators assigned to the process. It is therefore not necessary to specify an operator at the plugin level itself."}, {"location": "features/architecture/#cancelation-plugin", "title": "Cancelation Plugin", "text": "Function Return <code>getCode</code> CANCELATION <code>getLabel</code> Annulation <code>getDescription</code> Annule le traitement et d\u00e9finit la remarque pour le client <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018reason\u2019, \u2018label\u2019 : \u2018Raison de l\u2019annulation\u2019, \u2018type\u2019 : \u2018multitext\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 5000}]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003\u2018remark\u2019 : \u2018D\u00e9sol\u00e9, nous n'avons pas de donn\u00e9e sur cette zone\u2019}"}, {"location": "features/architecture/#mail-notification-plugin", "title": "Mail notification plugin", "text": "Function Return <code>getCode</code> NOTIFICATION <code>getLabel</code> Notification email <code>getDescription</code> Envoie une notification email personnalisable <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018emails\u2019, \u2018label\u2019 : \u2018Emails de destinataires, s\u00e9par\u00e9s par des points-virgules\u2019, \u2018type\u2019 : \u2018email\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018subject\u2019, \u2018label\u2019 : \u2018Objet du message\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018body\u2019, \u2018label\u2019 : \u2018Contenu du message\u2019, \u2018type\u2019 : \u2018multitext\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 5000}] <p>Note: This plugin supports dynamic strings in its settings according to the following keywords:</p> <ul> <li>{orderLabel}</li> <li>{orderGuid}</li> <li>{productGuid}</li> <li>{productLabel}</li> <li>{startDate}</li> <li>{organism}</li> <li>{client}</li> </ul>"}, {"location": "features/architecture/#qgis-server-atlas-plugin", "title": "QGIS Server Atlas Plugin", "text": "Function Return <code>getCode</code> QGISSERVERATLAS <code>getLabel</code> Impression Atlas QGIS Server <code>getDescription</code> Imprime les pages d\u2019un Atlas QGIS Server touch\u00e9es par le p\u00e9rim\u00e8tre, en PDF <code>getHelp</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getPictoClass</code> Se r\u00e9f\u00e9rer directement au connecteur <code>getParams</code> [\u2003{\u2018code\u2019 : \u2018url\u2019, \u2018label\u2019 : \u2018Url de base QGIS Server, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018template\u2019, \u2018label\u2019 : \u2018Template \u00e0 utiliser pour le layout\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018true\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018path\u2019, \u2018label\u2019 : \u2018Chemin du projet QGIS\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018login\u2019, \u2018label\u2019 : \u2018Login distant\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 50},\u2003{\u2018code\u2019 : \u2018pass\u2019, \u2018label\u2019 : \u2018Mot de passe\u2019, \u2018type\u2019 : \u2018pass\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 50},\u2003{\u2018code\u2019 : \u2018layers\u2019, \u2018label\u2019 : \u2018Layers \u00e0 utiliser (s\u00e9paration par des virgules)\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 255},\u2003{\u2018code\u2019 : \u2018crs\u2019, \u2018label\u2019 : \u2018CRS (Code EPSG)\u2019, \u2018type\u2019 : \u2018text\u2019, \u2018req\u2019 : \u2018false\u2019, \u2018maxlength\u2019 : 50}]Below is an example of the corresponding settings (task_params attribute in the TASK table):{\u2003\u2018url\u2019 : \u2018https://monserveur.lan/qgis-server',\u2003\u2018template\u2019 : \u2018myplan\u2019,\u2003\u2018path\u2019 : \u2018/etc/qgis-server/maps/world/world.qgs\u2019,\u2003\u2018login\u2019 : \u2018admin\u2019,\u2003\u2018pass\u2019 : \u2018password01\u2019,\u2003\u2018layers\u2019 : \u2018places,airports,water\u2019,\u2003\u2018crs\u2019 : \u2018EPSG:2056\u2019}"}, {"location": "features/architecture/#techincal-details", "title": "Techincal details", "text": ""}, {"location": "features/architecture/#rules-management", "title": "Rules Management", "text": "<p>The solution implements a syntactic language designed to interpret incoming requests and associate them with specific processes. Users can define rules consisting of one or more criteria, separated by a Boolean operator:</p> <p><code>criterion1 and/or criterion2 and/or criterion3 and/or \u2026 and/or criterionN</code></p> <p>Each criterion follows the following syntax:</p> <p><code>&lt;property&gt; &lt;operator&gt; &lt;value&gt;</code></p> <p>For example: <code>productguid == \u201c708e932b-81c3-2ce4-b907-ed07e61ac5f9\u201d</code></p>"}, {"location": "features/architecture/#properties", "title": "Properties", "text": "<p>The usable properties are listed in the table below. For each property, the type of operator that can be used (attribute/geographic) and the type of value to be entered (text/numeric/geometry) are indicated.</p> Property DB Field Description/Remark Operator Type Value Type <code>orderlabel</code> p_orderlabel p_orderlabel of the request element Attribute Text <code>orderguid</code> p_orderguid p_orderguid of the request element Attribute Text <code>productguid</code> p_product_guid p_product_guid of the request element Attribute Text <code>productlabel</code> p_productlabel p_productlabel of the request element Attribute Text <code>organism</code> p_organism p_organism of the request element Attribute Text <code>client</code> p_client p_client of the request element Attribute Text <code>tiers</code> p_tiers p_tiers of the request element Attribute Text <code>tiersguid</code> p_tiersguid p_tiersguid of the request element Attribute Text <code>perimeter</code> p_perimeter Perimeter of the request element, i.e., the export polygon in WKT format Geographic Geometry <code>surface</code> p_surface p_surface of the request element Attribute Numeric <code>parameters.xxx</code> p_parameters.xxx Dynamic property of the request element. Replace xxx with the desired property (e.g. format, projection, etc.) depending on the import connector. Attribute Depending on the type of dynamic property: text or numeric"}, {"location": "features/architecture/#operators", "title": "Operators", "text": "<p>Two types of operators are possible: attribute-based and geographic, depending on the property used.</p> <p>The table below contains a list of the attribute-based operators that can be used.</p> Operator Description/Remark <code>==</code> The property is equal to the value <code>!=</code> The property is different from the value <code>&gt;</code> The property is greater than the value <code>&lt;</code> The property is less than the value <code>&gt;=</code> The property is greater than or equal to the value <code>&lt;=</code> The property is less than or equal to the value <code>IN</code> The property is present in a list of values (specified in parentheses, separated by commas) <code>NOT IN</code> The property is not present in a list of values (specified in parentheses, separated by commas) <p>The table below contains a list of the geographic-based operators that can be used.</p> Operator Description/Remark <code>intersects</code> The geometry contained in the property intersects the geometry passed as a value <code>contains</code> The geometry contains the geometry passed as a value <code>disjoint</code> The geometry is completely disjoint from the geometry passed as a value <code>equals</code> The geometry is equal to the geometry passed as a value <code>within</code> The geometry is included in the geometry passed as a value"}, {"location": "features/architecture/#values", "title": "Values", "text": "<p>Depending on the property and operator, values can be of three types.</p> Value Type Description Example <code>Text</code> Text to be enclosed in quotation marks \"PDF\" <code>Numeric</code> Number (integer or decimal) 1234 <code>Geometry</code> Geometry converted to WKT format not enclosed in quotation marks POLYGON((6.82 46.39,6.92 46.39,6.92 46.19,6.92 46.19,6.82 46.39))LINESTRING(6.82 46.39, 6.92 46.39, 6.92 46.19)POINT(6.82 46.39)"}, {"location": "features/architecture/#examples", "title": "Examples", "text": "<p>Some typical examples of rules: <pre><code>orderlabel == \u201c92445\u201d AND perimeter intersects POLYGON((6.82 46.39,6.92 46.39,6.92 46.19,6.92 46.19,6.82 46.39))\n</code></pre></p> <pre><code>orderlabel == \u201c92445\u201d AND parameters.format == \u201cPDF\"\n</code></pre>"}, {"location": "features/architecture/#authentication", "title": "Authentication", "text": "<p>There are two types of users:</p> <ul> <li>LOCAL: users whose Extract database is the authentication source.</li> <li>LDAP: users whose LDAP server is the authentication source.</li> </ul> <p>To log in, LDAP users must be part of an Extract Admin or Extract Operator group in the LDAP directory.</p> <p>If a user logs in to Extract with LDAP and is not present in the local database, they are created on the fly.</p> <p>Each time an LDAP user logs in, their information is updated (name, email, role).</p> <p></p>"}, {"location": "features/architecture/#google-authenticator-2fa-operation", "title": "Google Authenticator 2FA operation", "text": ""}, {"location": "features/architecture/#2fa-specific-connection-flow", "title": "2FA-specific connection flow", "text": ""}, {"location": "features/architecture/#2fa-parameters-modification-for-your-own-account", "title": "2FA parameters modification (for your own account)", "text": ""}, {"location": "features/architecture/#2fa-parameters-modification-of-a-user-by-an-administrator", "title": "2FA parameters modification (of a user by an administrator)", "text": ""}, {"location": "features/architecture/#ldap-synchronization", "title": "LDAP synchronization", "text": "<p>It is possible to launch an LDAP synchronization (if LDAP authentication is enabled). This synchronization performs the following operations:</p> <ul> <li>Creation of LDAP Users (accounts existing in the LDAP directory, not yet in the Extract database)</li> <li>Updating the properties of existing LDAP users already in the Extract database (full name, email, role)</li> <li>Deactivating LDAP users from the Extract database if they are deactivated or deleted from the LDAP directory</li> </ul> <p></p> <p> </p>"}, {"location": "features/development/", "title": "Development", "text": ""}, {"location": "features/development/#packaging", "title": "Packaging", "text": "<p>Before packaging, you need to install the JS dependencies (i.e. node modules). Easiest approach is to use Docker: <pre><code>docker compose up -d\n</code></pre> Install dependencies: <pre><code>docker compose exec node bash  # open a bash session inside the node docker container\n\ncd extract\n./install_dependencies.sh  # run the script to install dependencies\n</code></pre></p> <p>Stop docker compose and generate a WAR of the application, run the following command:</p> <pre><code>mvn clean package\n</code></pre> <p>Package while skipping tests (compile and run) <pre><code>mvn clean package \"-Dmaven.test.skip\"  # add double quotes on windows powershell\n</code></pre></p> <p>In addition to the WAR file, the delivery archive of a new version contains:</p> <ul> <li>The latest version of the database update script     (<code>sql/update_db.sql</code>)</li> <li>The FME sample script (<code>fme/</code>)</li> </ul>"}, {"location": "features/development/#tests", "title": "Tests", "text": "<p>Unit tests can be run independently of packaging with the command:</p> <pre><code>mvn -q test -Punit-tests --batch-mode --fail-at-end\n</code></pre> <p>To run integration tests:</p> <pre><code>mvn -q verify -Pintegration-tests --batch-mode\n</code></pre> <p>For functional tests (requires the application to be running on localhost port 8080):</p> <pre><code>mvn -q verify -Pfunctional-tests --batch-mode\n</code></pre>"}, {"location": "features/development/#documentation-edit-and-build", "title": "Documentation (edit and build)", "text": "<p>If you would like to set up a local development environment to edit the current documentation, perform the following steps. You just need an installation of python 3 on your machine.</p> <ol> <li> <p>Create and activate a python virtual environment (not mandatory but recommended)     <pre><code>python -m venv .venv\n\nSet-ExecutionPolicy Unrestricted -Scope Process  # only for windows\n.venv\\Scripts\\Activate.ps1 \n</code></pre></p> </li> <li> <p>Install the necessary packages     <pre><code>pip install mkdocs-material mkdocs-exclude-search\n</code></pre></p> </li> <li> <p>Build and serve the documentation on localhost     <pre><code>mkdocs serve\n</code></pre></p> </li> <li>Visit http://localhost:8000</li> </ol> <p>You can then edit the markdown files under <code>./docs</code> following the syntax from mkdocs-material. The browser will automatically reload when changes are made to the <code>./docs</code> folder.</p> <p>To publish your modification, send them (only the markdown files) through a pull request on GitHub. When your pull request will be merged to the main branch, the documentation will automatically be build and publish to the documentation website.</p> <p> </p> <p></p>"}, {"location": "features/user-guide/", "title": "User guide", "text": ""}, {"location": "features/user-guide/#login", "title": "Login", "text": "<p>Access to the application is secured and requires authentication via either:</p> <ul> <li>A user account created by the administrator (see User Administration), or</li> <li>An account linked to the corporate LDAP directory (see LDAP authentication).</li> </ul> <p>Usernames are not case-sensitive, but passwords are case-sensitive.</p>"}, {"location": "features/user-guide/#reset-password", "title": "Reset password", "text": "<p>If you've forgotten your password, click the <code>Mot de passe oubli\u00e9 ?</code> link on the login screen. This will guide you through a two-step password reset process.</p> <p>Note</p> <p>This option is only available for local user accounts. If you're using LDAP authentication, please reset your password through your corporate directory. </p>"}, {"location": "features/user-guide/#1-request-reset-code", "title": "1. Request reset code", "text": "<p>Enter the email address associated with your user profile \u2014 the same one used to receive Extract notifications \u2014 and click <code>Demander la r\u00e9initialisation</code>. A message containing a verification code will be sent to that address. Enter the code on the next page to proceed.</p>"}, {"location": "features/user-guide/#2-reset", "title": "2. Reset", "text": "<p>Enter the code received by e-mail, then enter the desired password and confirm. The password must contain at least 8 characters. Then click on <code>R\u00e9initialiser le mot de passe</code>. If successful, you will be redirected to the login page with a message telling you that your password has been reset. You can now log in with your new password.</p> <p>Reset code validity</p> <p>The reset code remains valid only under the following conditions:</p> <ul> <li>Same session usage: The code must be used within the same browser session in which it was requested. Do not close or refresh the browser window after requesting the code.</li> <li>No login with old password: If you log in using your current (old) password after requesting the reset code, the code becomes invalid.</li> <li>Time limit: The code will expire automatically if not used within 20 minutes of being issued.</li> </ul> <p>If you're unable to reset your password or don't remember the email address associated with your account, please contact your administrator for assistance.</p>"}, {"location": "features/user-guide/#two-factor-authentication", "title": "Two-factor authentication", "text": "<p>Once 2FA is successfully activated and set up, users will be prompted to enter the verification code from their Google Authenticator app after logging in with their password. When checking the option <code>Faire confiance \u00e0 cet appreil pendant 30 jours</code> the 2FA code is no longer asked on the current device for 30 days. However, this does not enable automatic login, username and password will still be required.</p> <p>Recovery code</p> <p>If a user has lost access to Google Authenticator or accidentally deleted the associated Extract account entry, they can still access the application by clicking on the <code>Utiliser un code de r\u00e9cup\u00e9ration</code> link. They will then need to enter one of the recovery codes provided during the initial setup (see Two-Factor Authentication Setup).</p> <p>Important:</p> <ul> <li>Each recovery code can only be used once.</li> <li>After logging in, it is recommended to reset two-factor authentication via the user administration section.</li> </ul>"}, {"location": "features/user-guide/#current-user-administration", "title": "Current user administration", "text": "<p>On the right side of the menu bar, you\u2019ll find options related to the currently logged-in user.</p> <p>By clicking on the user\u2019s name, the following settings can be managed:</p> <p>For all users:</p> <ul> <li>Enable or disable two-factor authentication</li> <li>Choose whether to receive email notifications</li> <li>Change the language preference (if Extract is in multilingual mode)</li> </ul> <p>For local (non-LDAP) users only:</p> <ul> <li>Update full name</li> <li>Change username/login (must be unique within the application)</li> <li>Change email address (must be unique within the application)</li> <li>Change password</li> </ul> <p>Additionally, all users can log out by clicking the logout icon.</p>"}, {"location": "features/user-guide/#two-factor-authentication-setup", "title": "Two-Factor Authentication Setup", "text": "<p>When the user selects the drop-down button at the top of the page to enable or reset two-factor authentication, they are redirected to a registration page :</p> <p></p> <ol> <li> <p>Scan the QR Code</p> <p>Use Google Authenticator or any compatible app to scan the QR code displayed on screen. Alternatively, you can enter the code manually into the app.</p> </li> <li> <p>Enter the Verification Code</p> <p>Once the code is generated by your app, enter it in the field provided and click <code>Continuer</code>. If the code is correct, two-factor authentication (2FA) will be successfully enabled for your account.</p> </li> <li> <p>Save Recovery Codes</p> <p>A screen will then display single-use recovery codes. These can be used to access Extract in case you lose access to Google Authenticator.</p> <ul> <li>You can download or print these codes.</li> <li>Important: These codes will not be shown again, so store them in a secure location.</li> <li>Warning: Recovery codes allow access to your account without the second factor. Treat them as confidential.</li> </ul> </li> </ol> <p>If two-factor authentication is not mandatory for this user, you may choose to cancel the registration process. In this case, the account's 2FA status will remain unchanged:</p> <ul> <li>If 2FA was previously disabled, it stays disabled.</li> <li>If it was already enabled, it remains active with the previously configured setup.</li> </ul>"}, {"location": "features/user-guide/#requests-list", "title": "Requests list", "text": "<p>The home page provides a real-time overview of the application's activity, including:</p> <ul> <li>Status of active connectors</li> <li>Requests in progress</li> <li>History of completed requests</li> </ul> <p>Administrators can view all requests. Regular users only see requests associated with processes where they are assigned as operators.</p> <p>The page updates automatically based on the refresh interval defined in the application settings (see Orchestration Section). By default, this interval is set to 20 seconds.</p>"}, {"location": "features/user-guide/#status-of-active-connectors", "title": "Status of active connectors", "text": "<p>In the top-right corner of the page, chips show active connectors grouped by their current state:</p> <ul> <li>Flashing red chip: Indicates connectors that have encountered errors and exceeded the maximum number of retry attempts.</li> <li>Green chip: Represents connectors whose last import request was successful (regardless of whether request was imported or not), or those still within the allowed retry limit after an error.</li> </ul> <p>If no connectors fall under a particular status, the corresponding chip is not shown. For operators, only error messages may be visible.</p> <p>Clicking on a chip opens a dropdown listing the relevant connectors. Hovering over a connector displays a tooltip with the time of the last import and any associated error message. Administrators can click a connector to view and edit its settings (see Connectors detail).</p>"}, {"location": "features/user-guide/#requests-in-progress", "title": "Requests in progress", "text": "<p>The first table contains requests that have been imported but not yet processed. The background color of the line indicates the status:</p> <ul> <li>Green : Processing is running at expected</li> <li>Orange : Processing is paused pending operator validation</li> <li>Red : Processing stopped due to an error</li> </ul> <p>Clicking anywhere on a row opens the request details (refer to Request details). To open the request in a new tab or window, click directly on the request number.</p>"}, {"location": "features/user-guide/#completed-requests", "title": "Completed requests", "text": "<p>The second table lists requests that have been exported to their origin server. Due to its potentially large volume, it includes a filtering feature based on the following criteria:</p> <ul> <li> <p>Text search (partial and case insensitive) in the following fields:</p> <ul> <li>Request label</li> <li>Product label</li> <li>Customer name</li> <li>Third party name</li> </ul> </li> <li> <p>Connector through which the request was imported</p> </li> <li>Associated processing</li> <li>Request reception date using two date fields to define a range</li> </ul> <p>All search criteria are optional. When multiple criteria are specified, they are combined using the AND operator.</p> <p>The search is executed only when you click the green search button (magnifying glass icon). Alternatively, you can start the search by pressing Enter while focused on a text or date input field.</p>"}, {"location": "features/user-guide/#request-details", "title": "Request details", "text": ""}, {"location": "features/user-guide/#processing-status", "title": "Processing status", "text": "<p>The stages in the processing of the request are displayed at the top of the page, along with their status. The color code is as follows:</p> Color Status Light green The task has been successfully completed Dark green The task is running Orange The task awaits validation by an operator Red An error has occurred while running the task Grey Task has not yet been executed or has been skipped"}, {"location": "features/user-guide/#actions", "title": "Actions", "text": "<p>If processing is interrupted by an error or a validation request, an action box is displayed so that you can decide how to proceed.</p>"}, {"location": "features/user-guide/#validation", "title": "Validation", "text": "<p>When a task requires the processing status to be validated by an operator in order to continue, the following actions are available :</p> <ul> <li> <p>Validate: The operator determines that the processing is in the expected state and confirms that processing can continue normally. For this action, entering a comment is optional. If a comment has already been defined at a previous stage of processing, it is displayed in the text box. It is then possible to modify, replace, or even delete it. If at least one comment template has been defined for the validation of this processing, a drop-down list appears below the comment field. If an item from this list is selected, the corresponding text replaces the current validation comment. This text can be modified before validation.</p> </li> <li> <p>Cancel: The operator determines that the process cannot be successfully completed. The request will then be rejected and exported without result. No other tasks will be performed. In this case, a comment must be entered to explain to the customer why their request was rejected. If a comment has already been defined at a previous stage of the process, it will be displayed in the text box. It is then possible to modify, replace, or even delete it. If at least one comment template has been defined for canceling this processing, a drop-down list appears below the comment field. If an item from this list is selected, the corresponding text replaces the current cancellation comment. It is possible to modify this text before canceling.</p> </li> </ul> <p>Restart: Deletes all files generated so far for this request and runs the process from the beginning.</p>"}, {"location": "features/user-guide/#task-error", "title": "Task error", "text": "<p>When the last task ended with an error, the following actions are available.</p> <ul> <li>Retry: Runs the task that caused the error again.</li> <li>Restart: Deletes all files generated so far for this request and runs the process from the beginning.</li> <li>Continue: Ignores the current task and continues processing with the next task. If processing is complete, the result of the request is exported.</li> <li>Cancel: The operator determines that the processing cannot be successfully completed. The request will then be rejected and exported without a result. No other tasks will be executed. A comment must be entered to explain to the customer why their request was rejected.</li> </ul>"}, {"location": "features/user-guide/#no-processing-associated", "title": "No processing associated", "text": "<p>Info</p> <p>Only administrators can view this error status</p> <p></p> <p>If the request could not be associated with any processing based on the rules defined for the connector with which it was imported, the following actions are available.</p> <ul> <li>Retry: Restarts the process of associating the request with a process. This function is particularly useful when the connector rules have been modified to handle this specific case.</li> <li>Cancel: The administrator determines that the request cannot be processed successfully. It will then be rejected and exported without result. A comment must be entered to explain to the customer why their request was rejected.</li> </ul>"}, {"location": "features/user-guide/#import-error", "title": "Import error", "text": "<p>Info</p> <p>Only administrators can view this error status</p> <p></p> <p>If an error preventing the request from being processed is detected during import, only one action is possible:</p> <ul> <li>Cancel: The request will be rejected and exported without result. A comment must be entered to explain to the customer why their request was rejected.</li> </ul>"}, {"location": "features/user-guide/#export-error", "title": "Export error", "text": "<p>If the result of the request could not be sent to the original server, following actions are possible:</p> <ul> <li>Retry export: Attempts to send the result of the request again as is. This function is particularly useful in the event of a temporary error, such as server unavailability.</li> <li>Restart: Deletes all files generated so far for this request and runs the process from the beginning.</li> <li>Cancel: The administrator determines that the request cannot be processed successfully. It will then be rejected and exported without result. A comment must be entered to explain to the customer why their request was rejected.</li> </ul>"}, {"location": "features/user-guide/#request-information", "title": "Request information", "text": ""}, {"location": "features/user-guide/#customer-response", "title": "Customer response", "text": "<p>This section displays the information that will be returned to the customer in the current processing state.</p> <p>You can download the generated files by clicking on them. If more than one file is available, there is a button that allows you to download them all in a ZIP file.</p> <p>If the request has an error or is awaiting validation, files can be added to those that will be returned to the user using the <code>Ajouter des fichiers</code> button. Files can also be deleted by clicking on the red icon next to the file. Warning: Once the deletion confirmation has been accepted, this action cannot be undone.</p> <p>This section may not be displayed if no comments are defined, if the request's output directory does not contain any files, and if the request is not in a state that allows the files in the output directory to be modified.</p>"}, {"location": "features/user-guide/#customer-request", "title": "Customer request", "text": "<p>These are the parameters of the request as submitted by the customer.</p> <p>If the connector settings <code>URL de d\u00e9tail de commande</code> is set, a link in the panel header opens the original order details in a new window.</p> <p>On the map, two buttons allow you to download the order's footprint polygon in KML format (WGS84 coordinates) or DXF format (in the map's coordinate system).</p>"}, {"location": "features/user-guide/#processing-history", "title": "Processing history", "text": "<p>This table tracks all stages of request processing, including any new task executions, processing restarts, or ignored tasks.</p>"}, {"location": "features/user-guide/#administration-panel", "title": "Administration panel", "text": "<p>Info</p> <p>Only administrators can view this error status</p> <p></p> <p>This panel is collapsed by default and can be expanded by clicking on its title. </p> <p>It contains a button that allows you to delete a request. Processing will be immediately interrupted and no results will be returned to the client (not even a rejected request). This tool is intended as a last resort and should not be used during normal operation.</p> <p>In addition, it contains useful information for resolving potential problems, e.g. with FME scripts.</p> <p> </p>"}, {"location": "getting-started/configure/", "title": "Configure", "text": ""}, {"location": "getting-started/configure/#application-settings", "title": "Application settings", "text": "<p>Info</p> <p>The global application settings are found in the <code>application.settings</code> file at the root of the <code>WEB-INF\\classes</code> folder. Changes are taken into account when the Tomcat Extract application is restarted.</p> <p>application.external.url URL to access the application. This value is used to generate links in notification e-mails.</p> <p>database.encryption.secret Random 32-character ISO-8859-1 string used as key to encrypt certain database values.</p> <p>database.encryption.salt Random 32-character ISO-8859-1 string used as \"salt\" to encrypt certain database values.</p> <p>email.templates.cache Boolean value defining whether email notification templates should be cached.</p> <p>email.templates.encoding Encoding used by email notification templates</p> <p>email.templates.path Relative path to directory containing email notification templates. If the path is relative to the <code>WEB-INF/classes</code> directory, it must be prefixed with <code>classpath:/</code>.</p> <p>extract.i18n.language Language ISO code used by the application. A single code means the application is in monolingual mode. Several codes separated by comma means the application is in multilingual mode (language set in users preferences). In multilingual mode, the first one acts as the default language (e.g. for fallback, creation of first user, etc.). Here are a couple of examples:</p> <ul> <li><code>extract.i18n.language=fr</code> Extract is in french</li> <li><code>extract.i18n.language=de</code> Extract is in german</li> <li><code>extract.i18n.language=fr,de</code> Extract is in french and german, french being the default language</li> </ul> <p>All codes must have corresponding application's language files (usually <code>messages.properties</code>, <code>messages.js</code> and <code>*Help.html</code>) under <code>WEB-INF/classes</code>, <code>WEB-INF/classes/static/lang</code> and in all plugin <code>lang</code> directory. If this is not the case, you can add a new language (see Add a new language section).</p> <p>By default, Extract supports french (<code>fr</code>) and german (<code>de</code>).</p> <p>check.authenticity Boolean value defining if the signature of executable binaries run by Extract are checked or not. By default, the value is true <code>check.authenticity=true</code> but you can set it on <code>false</code> (it's known to cause antivirus alerts when set to <code>true</code>).</p> <p>http.proxyHost Server name to be used as proxy for external connections. This property can be omitted if no proxy is used.</p> <p>http.proxyPassword Password used to log in to the proxy server. This property can be omitted if no proxy is used or if it does not require authentication.</p> <p>http.proxyPort HTTP port of proxy server. This property can be omitted if no proxy is used.</p> <p>http.proxyUser Username used to log in to the proxy server. This property can be omitted if no proxy is used or if it does not require authentication.</p> <p>ldap.attributes.fullname LDAP attribute name containing the user's full name (e.g. John Doe).</p> <p>ldap.attributes.login LDAP attribute name containing the user's identifier, to be typed into the login form ( e.g. jdoe).</p> <p>ldap.attributes.mail LDAP attribute name containing the user's e-mail address.</p> <p>ldap.user.objectclass LDAP object class to which users must belong.</p> <p>logging.config Path to file containing application log configuration. If the path is relative to the application's <code>WEB-INF/classes</code> directory, it must be prefixed with <code>classpath:/</code>.</p> <p>spring.batch.jdbc.initialize-schema String defining whether the Spring Batch initializer should be started. This value must be set to <code>never</code> in order to avoid creating unused tables in the database.</p> <p>spring.batch.job.enabled Boolean value defining whether scheduled tasks should be started automatically by Spring Batch. Must be set to <code>false</code>. (These tasks are started by the application.)</p> <p>spring.datasource.driver-class-name Qualified name of the database driver class to be used.</p> <p>spring.datasource.password Database login password.</p> <p>spring.datasource.url JDBC database connection string.</p> <p>spring.datasource.username Database login username</p> <p>spring.servlet.multipart.max-file-size Maximum size of each file that can be uploaded to the application. If you receive a 500 error when adding a large file to a request folder, it may be useful to increase this value, remembering to also increase <code>spring.servlet.multipart.max-request-size</code> if necessary.</p> <p>spring.servlet.multipart.max-request-size Maximum size of an upload request. This value must be greater than or equal to that of <code>spring.servlet.multipart.max-file-size</code>.</p> <p>spring.jpa.database-platform Qualified name of the dialect class to be used to communicate with the database.</p> <p>spring.jpa.hibernate.ddl-auto Value defining the application's behaviour with regard to database architecture. By default, this property is set to <code>update</code>, which allows tables to be generated automatically when the application is first started. Subsequently, you can speed up application start-up by setting this value to <code>none</code>. In this case, if a table or column has been accidentally deleted, it will not be automatically recreated, which may lead to operating problems. It is also recommended to set this value back to <code>update</code> when installing a new version of Extract, so that any database modifications can be applied.</p> <p>spring.jpa.properties.hibernate.id.new_generator_mappings Boolean value defining whether to use the latest ID generator version for database entries. Must be set to <code>true</code>.</p> <p>spring.jpa.show-sql Boolean value defining whether to display SQL generated by the application (e.g. in logs). We strongly advise you to leave this value at <code>false</code>.</p> <p>spring.thymeleaf.cache Boolean value defining whether the application's pages templates should be cached.</p> <p>spring.thymeleaf.enabled Boolean value defining whether to enable the templating engine. Must be set to <code>true</code>.</p> <p>spring.thymeleaf.encoding Encoding used by the application's pages templates.</p> <p>spring.thymeleaf.mode Template type used for application pages. Must be set to <code>HTML</code>.</p> <p>spring.thymeleaf.prefix Path to directory containing application page templates. If the path is relative to the application's <code>WEB-INF/classe</code>s directory, it must be prefixed with <code>classpath:/</code>.</p> <p>spring.thymeleaf.suffix Application page templates extension.</p> <p>spring.thymeleaf.template-resolver-order Templating engine priority for resolving application page templates. Must be set to <code>1</code>.</p> <p>table.page.size Number of lines to display in tables using pagination.</p>"}, {"location": "getting-started/configure/#logging", "title": "Logging", "text": "<p>Info</p> <p>The logging application settings are found in the <code>logback-spring.xml</code> file at the root of the <code>WEB-INF\\classes</code> folder. They define what information should be written to the application logs. Changes are taken into account when the Tomcat Extract application is restarted.</p> <p>The setup takes place in two steps:</p> <ol> <li> <p>The setting of an <code>appender</code>, i.e. a location to which to send the information to be logged, and the format of this information. This can be a file, a database, a console, etc.</p> </li> <li> <p>The setting of a <code>logger</code>. A <code>logger</code> serves as the connection between a specific part of an application and one or more predefined <code>appenders</code>. A <code>logger</code> can simultaneously use multiple <code>appenders</code>, and a single <code>appender</code> can be shared by multiple <code>loggers</code>. The <code>logger</code> is identified by a name, corresponding to the package from which the class messages originate, encompassing any of its sub-packages. Additionally, the <code>logger</code> specifies a minimum level of messages to be logged. The root <code>logger</code> provides default logging behavior for all application classes, including  dependencies.</p> </li> </ol> <p>For more detailed information, please refer to the Logback help.</p>"}, {"location": "getting-started/configure/#tomcat-user-access-rights", "title": "Tomcat user access rights", "text": "<p>Since Extract is a Tomcat application, it relies on the user running the Tomcat service to access various resources (network shares, local folders, etc.). It is therefore recommended to run the Tomcat service with an account having access to the necessary resources.</p>"}, {"location": "getting-started/configure/#changing-the-tomcat-user-windows", "title": "Changing the Tomcat user (Windows)", "text": "<ol> <li>Open the Tomcat monitor (<code>tomcat8w.exe</code>, or <code>Start Menu &gt; All Programs &gt; Apache Tomcat &gt; Configure Tomcat</code>)</li> <li>Go to the <code>Log On</code> tab</li> <li>Check the <code>This account</code> option</li> <li>Edit the desired account information</li> <li>Click on OK</li> <li>Restart the Tomcat service</li> </ol>"}, {"location": "getting-started/configure/#changing-the-tomcat-user-linux", "title": "Changing the Tomcat user (Linux)", "text": "<ol> <li>Edit the <code>/etc/systemd/system/tomcat9.service</code> file</li> <li>In the <code>Service</code> category, change the values of the <code>User</code> and <code>Group</code> keys to the user's name and group respectively.</li> <li>Save the file</li> <li>Restart the Tomcat service</li> </ol> <p>Warning</p> <p>The name of the file, its location and even the entire procedure may differ depending on the distribution used, the version of Tomcat and its installation mode.</p>"}, {"location": "getting-started/configure/#tomcat-default-locale", "title": "Tomcat default locale", "text": "<p>In emails sent by Tomcat, dates are formatted according to Tomcat's locale. To set this, use the Duser.language and Duser.region parameters. For example : <pre><code>-Duser.language=fr -Duser.region=CH\n</code></pre></p> <p>These parameters are defined in the same way as for heap size (see Heap Size).</p>"}, {"location": "getting-started/configure/#optimizing", "title": "Optimizing", "text": ""}, {"location": "getting-started/configure/#heap-size", "title": "Heap size", "text": "<p>The FME Desktop scripts run by Extract can lead to heavy heap usage. If you are using this plugin, it is recommended that you set the starting size of the heap (parameter <code>Xms</code>) to 1024 MB and the maximum size (parameter <code>Xmx</code>) to at least 2048 MB.</p> <p>These parameters are set in the <code>setenv.sh</code> (Linux) or <code>setenv.bat</code> (Windows) file in Tomcat's bin directory.</p> <p>If Tomcat is running as a Windows service, these parameters are defined in the <code>Java</code> tab of the service properties. This tab can only be accessed via the Tomcat monitor (<code>tomcat8w.exe</code>, or <code>Start Menu &gt; All Programs &gt; Apache Tomcat &gt; Configure Tomcat</code>). It is not visible via the Windows services management console (services.msc).</p> <p>In all cases, Tomcat must be restarted for the changes to take effect.</p>"}, {"location": "getting-started/configure/#cache-size", "title": "Cache Size", "text": "<p>During startup, the logs may report that an item failed to load due to insufficient cache size, for example:</p> <pre><code>24-May-2017 10:52:57.029 WARNING [https-jsse-nio-8443-exec-10] org.apache.catalina.webresources.Cache.getResource Unable to add the resource at [/WEB-INF/classes/static/bower_components/select2/docs/_sass/vendor/font-awesome/_variables.scss] to the cache for web application [/extract] because there was insufficient free space available after evicting expired cache entries - consider increasing the maximum size of the cache\n</code></pre> <p>In this case, you can increase the maximum cache size by modifying the <code>context.xml</code> file in Tomcat's <code>conf</code> directory :</p> <pre><code>&lt;Context&gt;\n    &lt;!-- ... --&gt;\n\n    &lt;!-- Larger resources cache for EXTRACT --&gt;\n    &lt;Resources cacheMaxSize=\"102400\" /&gt;\n\n    &lt;!-- ... --&gt;\n&lt;/Context&gt;\n</code></pre>"}, {"location": "getting-started/configure/#rule-field-size-limitation-matching-processes", "title": "Rule field size limitation (matching processes)", "text": "<p>Since the creation of text fields is problematic when handled solely with JPA (so that the application is not tied to a particular database system), It was decided to define the field that stores the rules linking requests to their corresponding processing as a <code>VARCHAR</code> data type. Unfortunately, this means limiting the number of characters in each rule to 65,000.</p> <p>Using PostgreSQL, however, you can remove this limitation by manually changing the type of the rule field in the rules table. The SQL command to make this change is :</p> <pre><code>ALTER TABLE rules ALTER COLUMN rule TYPE TEXT\n</code></pre> <p>Field values of existing records are preserved.</p> <p>Warning</p> <p>There is no guarantee that a similar modification will work with another DBMS.</p> <p> </p>"}, {"location": "getting-started/customize/", "title": "Customize", "text": ""}, {"location": "getting-started/customize/#add-a-new-language", "title": "Add a new language", "text": ""}, {"location": "getting-started/customize/#for-the-main-module", "title": "For the main module", "text": "<p>You can set a new language for the Extract application user interface. If you want to translate the main module of Extract, do the following :</p> <ol> <li>Create a new <code>messages_{lang-code}.properties</code> files under <code>WEB-INF\\classes</code> named after the two-character ISO code of the desired language (e.g. <code>messages_it.properties</code>)</li> <li>Create a new directory in <code>WEB-INF\\classes\\static\\lang</code>, named after the two-character ISO code of the desired language (e.g. <code>it</code>)</li> <li>Copy the contents of a previously defined language directory (<code>messages.js</code> and any <code>html</code> files)</li> <li>Translate all messages stored in these files</li> </ol> <p>The date selector used on the home page can also be translated. Its language files are located in the <code>WEB-INF\\classes\\static\\lib\\bootstrap-datepicker\\dist\\locales</code> directory. If the desired language is not yet defined :</p> <ol> <li>Copy an existing language file by changing the language code in its name</li> <li>Translate all containing strings</li> </ol> <p>To apply the new language, update the <code>extract.i18n.language</code> property in the <code>WEB-INF\\classes\\application.properties</code> file, then restart the Tomcat application (see Application settings)</p>"}, {"location": "getting-started/customize/#for-plugins", "title": "For plugins", "text": "<p>If you want to translate connector and extraction plugin as well, the easiest is to work on the code base of Extract and re-package the application :</p> <ol> <li>In all plugins, create a new directory under <code>{plugin-name/src/main/resources/plugins/lang}</code>, named after the two-character ISO code of the desired language (e.g. <code>it</code>)</li> <li>Copy the contents of a previously defined language directory (<code>messages.properties</code>, <code>messages.js</code> and any <code>html</code> files)</li> <li>Translate all messages stored in these files</li> <li>Re-package the application <code>mvn clean package \"-Dmaven.test.skip\"</code> and re-deploy it on tomcat</li> </ol>"}, {"location": "getting-started/customize/#fallback-language", "title": "Fallback language", "text": "<ul> <li>For all <code>messages.properties</code> and <code>messages.js</code> files, there is a fallback mechanism that if a key is missing in a localization file, it tries first to find it in the default language (the first one specified in the <code>extract.i18n.language</code> property), than in french.</li> <li>For all <code>*Help.html</code> files, there is no fallback mechanism. If the file is missing, the tooltip help will be empty.</li> </ul>"}, {"location": "getting-started/customize/#plugins", "title": "Plugins", "text": "<p>Info</p> <p>The type of connector providing the requests and the tasks that can be included in a process are managed by plugins that can be added, removed or updated independently of the application itself.</p>"}, {"location": "getting-started/customize/#installing-or-updating-a-plugin", "title": "Installing or updating a plugin", "text": "<p>If a new connector type or a new task is available, simply place its JAR in the <code>WEB-INF/classes/connectors</code> (for connectors) or <code>WEB-INF/classes/task_processors</code> (for tasks) directory. When performing an upgrade, it is recommended to delete the JAR file of the previous version to prevent any potential conflicts.</p> <p>After making changes to the plugins, the Tomcat Extract application must be restarted.</p>"}, {"location": "getting-started/customize/#development-of-a-new-connector-plugin", "title": "Development of a new connector plugin", "text": "<p>Info</p> <p>Documented sample code is available to help you create a new connector. You'll find it in the docs folder of the application repository : https://github.com/asit-asso/extract/tree/master/docs/extract-connector-sample.</p> <ul> <li>The project must be structured as a Java module, requiring the inclusion of a <code>module-info.java</code> file that declares its dependencies</li> <li>The new connector project must define a dependency on the <code>extract-interface</code> project</li> <li>The connector's main class must implement the <code>IConnector</code> interface</li> <li>The connector must declare a constructor without parameters</li> <li>The value returned by the <code>getCode</code> method must be unique across all Extract connectors</li> <li>The <code>getParams</code> method must return the connector's parameters as a JSON-formatted array. If the connector doesn't accept parameters, return an empty array (<code>[]</code>).</li> <li>Static files used by the connector (such as property files, language files, etc.) should be placed in the <code>resources/connectors/&lt;plugin code&gt;/</code> subdirectory.</li> <li>A file named <code>ch.asit_asso.extract.connectors.common.IConnector</code> must be created in the <code>resources/META-INF/services</code> subdirectory. The file should contain the fully qualified name of the main class.</li> </ul>"}, {"location": "getting-started/customize/#development-of-a-new-task-plugin", "title": "Development of a new task plugin", "text": "<p>Info</p> <p>Documented sample code is available to help you create a new connector. You'll find it in the docs folder of the application repository : https://github.com/asit-asso/extract/tree/master/docs/extract-task-sample.</p> <ul> <li>The project must be structured as a Java module, requiring the inclusion of a <code>module-info.java</code> file that declares its dependencies</li> <li>The new task project must define a dependency on the <code>extract-interface</code> project</li> <li>The task's main class must implement the <code>ITaskProcessor</code> interface</li> <li>The task plugin must declare a constructor without parameters</li> <li>The value returned by the <code>getCode</code> method must be unique across all Extract tasks</li> <li>The <code>getParams</code> method must return the plugin parameters as a JSON-formatted array. If the plugin doesn't accept parameters, return an empty array (<code>[]</code>).</li> <li>The <code>getPicto</code> method must return the name of the FontAwesome icon to be displayed in the plugin's title bar</li> <li>Static files used by the plugin (such as property files, language files, etc.) should be placed in the <code>resources/plugin/&lt;plugin code&gt;/</code> subdirectory.</li> <li>A file named <code>ch.asit_asso.extract.plugins.common.ITaskProcessor</code> must be created in the <code>resources/META-INF/services</code> subdirectory. The file should contain the fully qualified name of the plugin main class. If this requirement is not met, the plugin will not be detected by Extract.</li> <li> <p>The task plugin is allowed to modify specific attributes (see below) of the original request when returning a result :</p> Attribute Purpose <code>rejected</code> Indicates whether Extract should process the request. If set to <code>true</code>, the processing is interrupted and the request is immediately exported back to the origin server without any result. In this case, the <code>remark</code> attribute must be provided to explain the reason for the interruption. <code>remark</code> An explanatory note included with the request to inform the requester about how their data is being processed. It's recommended to append this note to the original attribute content to preserve all existing information. </li> </ul> <p>Changes to any other request attributes will be ignored.</p>"}, {"location": "getting-started/customize/#basemap", "title": "Basemap", "text": "<p>To customize the map layers that display the order perimeter within the request details view, create a configuration file named <code>map.custom.js</code> and place it under the <code>WEB-INF/classes/static/js/requestMap</code> directory.</p> <p>This directory includes a <code>map.custom.js.dist</code> file that provides an example configuration, which you can use as a template to create your own setup.</p> <p>The following constraints apply :</p> <ul> <li>The <code>map.custom.js</code> file defines an <code>initializeMap</code> function, which returns a <code>Promise</code> that resolves with the initialized map instance.</li> <li>The map's <code>target</code> property must be set to the string <code>\"orderMap\"</code>.</li> <li>Each map layer must include a <code>title</code> attribute in its <code>options</code>. This title will be used as a label in the layer list widget.</li> <li>Any layer representing a base map must include a <code>type</code> attribute in its <code>options</code> with the value <code>\"base\"</code></li> </ul>"}, {"location": "getting-started/customize/#system-emails", "title": "System emails", "text": "<p>Emails are generated using HTML templates with the Thymeleaf 3.1 engine (learn more at Thymeleaf Documentation). These templates can be found in the following directory: <code>WEB-INF\\classes\\templates\\email\\html</code>. The relevant files are listed below:</p> Path Usage <code>layout\\master</code> General layout used by all system emails <code>exportFailed.html</code> Request's export failed <code>importFailed.html</code> Request's import failed <code>invalidProductImported.html</code> An imported request includes a product that cannot be processed <code>passwordReset.html</code> Send password reset code <code>taskFailed.html</code> Request processing interrupted due to an error <code>taskStandby.html</code> Request processing awaits an operator validation <code>taskStandbyNotification.html</code> Remind that a request is still awaiting validation <code>unmatchedRequest.html</code> An imported request does not met any rule defined for the connector <p>The message delivery follows the Model-View-Controller (MVC) architecture. The content displayed in the message depends on the data transmitted by Extract..</p> <p>To support internationalization of the application, all displayed strings, including emails, are stored in language-specific files. These files can be found in the <code>WEB-INF\\classes\\messages_{language}.properties</code> file. The strings are defined using the following format:</p> <pre><code>string.id=Value text\n</code></pre> <p>Parameters within strings are specified by their index (starting from 0) enclosed in curly braces. For example, <code>{0}</code> refers to the first parameter.</p> <p>Warning : Ensure that the number of parameters expected by the string matches the number of parameters provided. Otherwise, message delivery will fail.</p> <p>In email templates, strings are specified using the <code>th:text</code> attribute. When the string does not require any parameters, use the following syntax:</p> <pre><code>th:text=\"#{string.id}\"\n</code></pre> <p>When the string does require parameters, use the following syntax:</p> <pre><code>th:text=\"${#messages.msg('string.id', param0, param1,\u2026)}\"\n</code></pre> <p>The plain text in email templates serves only as a placeholder for previewing the template in an HTML viewer. When the email is generated, these placeholders are automatically replaced with the corresponding values from the language file.</p> <p>Following parameters can be used (provided that this information is available when sending the email) :</p> <ul> <li><code>orderLable</code> : request's label</li> <li><code>productLabel</code> : Product name</li> <li><code>startDate</code> : Submission date (e.g., \u201c20 nov. 2025, 10:24:49\u201d)</li> <li><code>startDateISO</code> : Submission date ISO (e.g., \u201c2025-11-20T09:24:49.221Z\u201d)</li> <li><code>endDate</code> : End date (e.g., \u201c20 nov. 2025, 10:24:49\u201d)</li> <li><code>endDateISO</code> : End date ISO (e.g., \u201c20 nov. 2025, 10:24:49\u201d)</li> <li><code>status</code> : Request status</li> <li><code>rejected</code> : Boolean, true if the request was rejected</li> <li><code>client</code> or <code>clientName</code> : Client name</li> <li><code>clientGuid</code> : Unique client identifier</li> <li><code>organism</code> or <code>organisationName</code> : Client organization name</li> <li><code>organismGuid</code> : Unique organization identifier</li> <li><code>tiers</code> : Third party organization name</li> <li><code>perimeter</code> : Geographic perimeter (WKT format)</li> <li><code>surface</code> : Area of the order</li> </ul> <p>The dynamic parameter can be accessed as follow :</p> <p><code>parameter.KEY_NAME</code>, e.g. <code>parameter.FORMAT</code> for the format if exists.</p> <p>Parameter can also be used outside of a localized string using the following syntax :</p> <pre><code>&lt;p th:text=\"${clientName}\"&gt;&lt;/p&gt;\n</code></pre> <p>If a parameter does not exist, the value is replaced by an empty string. If a dynamic parameter does not exist, the value is replaced by <code>null</code>.</p> <p> </p>"}, {"location": "getting-started/cybersecurity-linux/", "title": "Security recommendations for Tomcat 9 deployments (Linux)", "text": ""}, {"location": "getting-started/cybersecurity-linux/#priority-summary", "title": "Priority Summary", "text": "<ol> <li>Run Tomcat as a non-root user and enforce strict file permissions.</li> <li>Add TLS 1.2/1.3 with FIPS-validated ciphers and HSTS.</li> <li>Harden cookie security (HttpOnly and Secure flags).</li> <li>Enable AccessLogValve and log client IPs behind proxies.</li> <li>Patch Tomcat regularly and enable LockOutRealm.</li> <li>Remove unnecessary applications and connectors and harden the shutdown port.</li> <li>Disable auto-deployment and stack tracing.</li> <li>Audit file changes and protect the keystore.</li> </ol>"}, {"location": "getting-started/cybersecurity-linux/#1-run-tomcat-as-a-non-root-user", "title": "1. Run Tomcat as a non-root user", "text": "<p>Running Tomcat as a non-root user is a critical security practice. If Tomcat were to be compromised while running as root, an attacker would gain full control of the server. By running it under a limited, non-root user, the potential damage is restricted to the Tomcat environment, reducing the risk to the overall system.</p> <ul> <li>Why it matters: Minimizes privileges and limits the damage an attacker can inflict if they gain access to Tomcat.</li> </ul> <p>How-to</p> <ol> <li> <p>Create a user and group for Tomcat: <pre><code>sudo useradd -s /sbin/nologin -g tomcat -d $CATALINA_BASE tomcat\n</code></pre></p> </li> <li> <p>Set the ownership: <pre><code>sudo chown -R tomcat:tomcat $CATALINA_BASE\n</code></pre></p> </li> <li> <p>Run Tomcat under the <code>tomcat</code> user:</p> <ul> <li> <p>Open <code>tomcat.service</code> (assuming Tomcat is managed by <code>systemd</code>): <pre><code>sudo nano /etc/systemd/system/tomcat.service\n</code></pre></p> </li> <li> <p>Ensure the following lines are set to run Tomcat as the <code>tomcat</code> user: <pre><code>[Unit]\nDescription=Apache Tomcat Web Application Container\nAfter=syslog.target network.target\n\n[Service]\nType=forking\nUser=tomcat\nGroup=tomcat\n\nReadWritePaths=/var/log/extract/\n\nEnvironment=JAVA_HOME=/usr/lib/jvm/jdk-17.0.12-oracle-x64\nEnvironment=CATALINA_PID=/opt/apache-tomcat-9.0.95/temp/tomcat.pid\nEnvironment=CATALINA_HOME=/opt/apache-tomcat-9.0.95\nEnvironment=CATALINA_BASE=/opt/apache-tomcat-9.0.95\nEnvironment=CATALINA_OPTS=\nEnvironment=\"JAVA_OPTS=-Dfile.encoding=UTF-8 -Dnet.sf.ehcache.skipUpdateCheck=true -Xms2g -Xmx4g\"\n\nExecStart=/opt/apache-tomcat-9.0.95/bin/startup.sh\nExecStop=/opt/apache-tomcat-9.0.95/bin/shutdown.sh\n\n[Install]\nWantedBy=multi-user.target \n</code></pre></p> <p>The line <code>ReadWritePaths=/var/log/extract</code> is mandatory because of the new sandboxing imposed by the <code>systemd</code> service manager.</p> </li> <li> <p>Reload <code>systemd</code> in order to discover and load the new Tomcat service file: <pre><code>systemctl daemon-reload\n</code></pre></p> </li> <li> <p>Enable the service to start at boot: <pre><code>systemctl enable tomcat.service\n</code></pre></p> <p>To control the service: <pre><code>service tomcat [start | stop | restart | status]\n</code></pre></p> <p>Or with Systemd directly: <pre><code>systemctl [start | stop | restart | status] tomcat\n</code></pre></p> </li> <li> <p>Reload systemd and restart Tomcat: <pre><code>sudo systemctl daemon-reload\nsudo systemctl restart tomcat\n</code></pre></p> </li> </ul> </li> </ol>"}, {"location": "getting-started/cybersecurity-linux/#2-set-proper-file-permissions", "title": "2. Set proper file permissions", "text": "<ul> <li>$CATALINA_HOME folder must be owned by the root user, group <code>tomcat</code>.</li> <li>$CATALINA_HOME/conf folder must be owned by the root user, group <code>tomcat</code>.</li> <li>$CATALINA_BASE/logs folder must be owned by the tomcat user, group <code>tomcat</code>.</li> <li>$CATALINA_BASE/work folder must be owned by the tomcat user, group <code>tomcat</code>.</li> <li>Permissions:<ul> <li>$CATALINA_BASE/logs: <code>750</code></li> <li>$CATALINA_HOME/bin: <code>750</code></li> <li>Files in $CATALINA_BASE/logs: <code>640</code></li> <li>JAR files in $CATALINA_HOME/bin: <code>640</code></li> </ul> </li> </ul> <p>Proper file permissions ensure that only authorized users can access or modify critical Tomcat files and directories. Limiting access to configuration files (e.g., <code>server.xml</code>) to root, while allowing Tomcat-specific logs and runtime files to be owned by the <code>tomcat</code> user, strengthens the security by preventing unauthorized changes.</p> <ul> <li>Why it matters: Prevents unauthorized access or modification of sensitive configuration files and logs.</li> </ul> <p>How-to</p> <ul> <li> <p>Change the ownership: <pre><code>sudo chown -R root:tomcat $CATALINA_HOME\nsudo chown -R tomcat:tomcat $CATALINA_HOME/{logs,temp,webapps,work}\n</code></pre></p> </li> <li> <p>Change file permissions: <pre><code>sudo chmod -R 750 $CATALINA_HOME/bin\nsudo chmod -R 750 $CATALINA_HOME/logs\nsudo find $CATALINA_HOME/logs -type f -exec chmod 640 {} \\;\nsudo find $CATALINA_HOME/bin -type f -name \"*.jar\" -exec chmod 640 {} \\;\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#3-add-tls-v12-or-v13-with-fips-validated-ciphers", "title": "3. Add TLS v1.2 or v1.3 with FIPS-validated ciphers", "text": "<p>TLS (Transport Layer Security) is essential for encrypting data transmitted between clients and servers. By enforcing TLS 1.2 or 1.3 with strong, FIPS-validated ciphers, you ensure secure communication that meets strict compliance standards.</p> <ul> <li>Why it matters: Encrypts sensitive data in transit and complies with modern security standards like FIPS 140-2.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit the <code>server.xml</code> file: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Change file permissions: <pre><code>&lt;Connector port=\"8443\" protocol=\"org.apache.coyote.http11.Http11NioProtocol\" maxThreads=\"150\" SSLEnabled=\"true\"&gt;\n    &lt;SSLHostConfig&gt;\n        &lt;Protocols&gt;\n            &lt;TLSv1.2 /&gt;\n            &lt;TLSv1.3 /&gt;\n        &lt;/Protocols&gt;\n        &lt;Cipher&gt;TLS_AES_128_GCM_SHA256, TLS_AES_256_GCM_SHA384, TLS_CHACHA20_POLY1305_SHA256&lt;/Cipher&gt; \n        &lt;Certificate certificateKeyFile=\"conf/server.key\" certificateFile=\"conf/server.crt\" certificateChainFile=\"conf/chain.crt\" type=\"RSA\" /&gt;\n    &lt;/SSLHostConfig&gt; \n&lt;/Connector&gt;\n</code></pre></p> </li> <li> <p>Restart Tomcat: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#4-add-http-strict-transport-security-hsts", "title": "4. Add HTTP Strict Transport Security (HSTS)", "text": "<p>HSTS instructs browsers to only interact with your server using HTTPS. It prevents downgrade attacks where an attacker could force a user to connect via HTTP. Once a browser receives the HSTS header, it will automatically convert all future requests to HTTPS, ensuring secure communication.</p> <ul> <li>Why it matters: Protects against protocol downgrade attacks and ensures that all communications use HTTPS.</li> </ul> <p>How-to</p> <ul> <li> <p>Modify the <code>web.xml</code> file in the default web app: <pre><code>sudo nano /opt/tomcat/conf/web.xml\n</code></pre></p> </li> <li> <p>Change the filter values: <pre><code>&lt;filter&gt;\n    &lt;filter-name&gt;HSTSFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.catalina.filters.HttpHeaderSecurityFilter&lt;/filter-class&gt; \n    &lt;init-param&gt; \n        &lt;param-name&gt;hstsEnabled&lt;/param-name&gt;\n        &lt;param-value&gt;true&lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;init-param&gt; \n        &lt;param-name&gt;hstsMaxAgeSeconds&lt;/param-name&gt; \n        &lt;param-value&gt;31536000&lt;/param-value&gt; \n    &lt;/init-param&gt; \n&lt;/filter&gt; \n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;HSTSFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre></p> </li> <li> <p>Restart Tomcat: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#5-disable-x-powered-by-header", "title": "5. Disable X-Powered-By Header", "text": "<p>By default, Tomcat may expose the <code>X-Powered-By</code> header, which discloses information about the server and its version. Disabling this prevents attackers from easily identifying the version of Tomcat being used, reducing the risk of targeted attacks based on known vulnerabilities.</p> <ul> <li>Why it matters: Hides unnecessary information from potential attackers and reduces the risk of exploit-based attacks.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit the <code>server.xml</code> file: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Change file permissions: <pre><code>&lt;Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showReport=\"false\" showServerInfo=\"false\" /&gt;\n</code></pre></p> </li> <li> <p>Restart Tomcat: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#6-harden-cookie-security-httponly-secure-flags", "title": "6. Harden Cookie Security (HttpOnly &amp; Secure flags)", "text": "<ul> <li>HttpOnly flag: Ensures that cookies cannot be accessed via JavaScript, protecting them from cross-site scripting (XSS) attacks.</li> <li>Secure flag: Ensures that cookies are only transmitted over HTTPS, preventing them from being exposed during plaintext transmission.</li> <li>Why it matters: Protects session cookies from being stolen or accessed by malicious scripts.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit the <code>web.xml</code> file: <pre><code>sudo nano /opt/tomcat/conf/web.xml\n</code></pre></p> </li> <li> <p>Set the cookie properties: <pre><code>&lt;session-config&gt;\n    &lt;cookie-config&gt;\n        &lt;http-only&gt;true&lt;/http-only&gt;\n        &lt;secure&gt;true&lt;/secure&gt;\n    &lt;/cookie-config&gt;\n&lt;/session-config&gt;\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#7-enable-accesslogvalve-for-each-virtual-host", "title": "7. Enable AccessLogValve for each virtual host", "text": "<p>Configuring AccessLogValve for each virtual host in Tomcat allows you to log incoming requests for auditing and troubleshooting purposes. These logs provide valuable insights into who is accessing the server and can help detect potential malicious activity.</p> <ul> <li>Why it matters: Provides detailed logs for auditing, forensics, and detecting suspicious activity.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit the <code>server.xml</code> file: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Change file permissions: <pre><code>&lt;Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"false\" autoDeploy=\"false\"&gt;\n&lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\nprefix=\"localhost_access_log\" suffix=\".txt\"\npattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n&lt;/Host&gt;\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#8-regularly-patch-tomcat-for-security-vulnerabilities", "title": "8. Regularly patch Tomcat for security vulnerabilities", "text": "<p>Tomcat, like any other software, can have security vulnerabilities. Regularly applying patches and updates ensures that your installation is protected against known threats. It\u2019s crucial to stay up to date with the latest security patches to mitigate risks.</p> <ul> <li>Why it matters: Fixes known vulnerabilities and prevents attackers from exploiting outdated software.</li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#9-use-lockoutrealm-to-prevent-brute-force-attacks", "title": "9. Use LockOutRealm to prevent brute-force attacks", "text": "<p>The LockOutRealm helps prevent brute-force login attacks by locking out users after a set number of failed login attempts. Configuring this for admin accounts is particularly important.</p> <ul> <li>Why it matters: Prevents attackers from brute-forcing admin credentials.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit the <code>server.xml</code> file: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Add <code>failureCount</code> et <code>lockOutTime</code>: <pre><code>&lt;Realm className=\"org.apache.catalina.realm.LockOutRealm\" failureCount=\"5\" lockOutTime=\"600\"&gt;\n  &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n         resourceName=\"UserDatabase\"/&gt;\n&lt;/Realm&gt;\n</code></pre></p> </li> <li> <p>Restart Tomcat: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#10-secure-the-keystore-file", "title": "10. Secure the keystore file", "text": "<p>The keystore contains sensitive information, such as private keys used for SSL/TLS. Ensuring that the keystore file is properly protected by strict file permissions and password protection prevents unauthorized access to critical security credentials.</p> <ul> <li>Why it matters: Protects sensitive private keys from unauthorized access or tampering.</li> </ul> <p>How-to</p> <ul> <li>Apply the modifications: <pre><code>sudo chmod 600 /path/to/keystore\nsudo chown tomcat:tomcat /path/to/keystore\n</code></pre></li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#11-audit-file-changes-to-critical-directories", "title": "11. Audit file changes to critical directories", "text": "<p>Changes to $CATALINA_HOME/lib, $CATALINA_HOME/bin, and $CATALINA_BASE/conf should be logged. Auditing these changes provides insight into potential tampering or unauthorized modifications to critical Tomcat files.</p> <ul> <li>Why it matters: Helps in detecting suspicious or unauthorized modifications that could compromise the server.</li> </ul> <p>How-to</p> <ul> <li> <p>Add the auditing rules: <pre><code>sudo apt install auditd\n</code></pre></p> </li> <li> <p>Add the auditing rules: <pre><code>sudo auditctl -w /opt/tomcat/lib -p wa -k tomcat_lib_changes\nsudo auditctl -w /opt/tomcat/bin -p wa -k tomcat_bin_changes\nsudo auditctl -w /opt/tomcat/conf -p wa -k tomcat_conf_changes\nsudo auditctl -l\n</code></pre></p> </li> <li> <p>View logs: <pre><code>sudo ausearch -k tomcat_lib_changes\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#12-remove-unnecessary-applications-and-connectors", "title": "12. Remove unnecessary applications and connectors", "text": "<ul> <li>Remove folders: Unused folders such as <code>documentation</code>, <code>examples</code>, <code>manager</code>, and <code>host-manager</code> should be deleted from the production environment to minimize the attack surface.</li> <li>Remove unused connectors: Disable and remove any unused connectors (e.g., HTTP connector) to reduce exposure to attacks.</li> <li>Why it matters: Minimizes the attack surface and reduces potential entry points for attackers.</li> </ul> <p>How-to</p> <ul> <li> <p>Remove example apps and manager apps: <pre><code>sudo rm -rf /opt/tomcat/webapps/examples\nsudo rm -rf /opt/tomcat/webapps/manager\nsudo rm -rf /opt/tomcat/webapps/host-manager\n</code></pre></p> </li> <li> <p>Disable unused connectors in <code>server.xml</code>: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Comment out or remove unused connectors.</p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#13-log-client-ip-behind-proxies-or-load-balancers", "title": "13. Log client IP behind proxies or load balancers", "text": "<p>When Tomcat is behind a proxy or load balancer, it\u2019s important to log the client\u2019s actual IP address, not the proxy\u2019s IP. This helps identify the true origin of requests.</p> <ul> <li>Why it matters: Enables accurate identification of the source of traffic, which is crucial for auditing and security monitoring.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit <code>server.xml</code> to add <code>RemoteIpValve</code> within the <code>&lt;Host&gt;</code> section: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Add the valve: <pre><code>&lt;Valve className=\"org.apache.catalina.valves.RemoteIpValve\"\n       remoteIpHeader=\"x-forwarded-for\"\n       protocolHeader=\"x-forwarded-proto\"\n       protocolHeaderHttpsValue=\"https\" /&gt;\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#14-disable-auto-deployment-and-stack-tracing", "title": "14. Disable auto-deployment and stack tracing", "text": "<ul> <li>AutoDeploy allows dynamic deployment of new applications while Tomcat is running, which can lead to unauthorized changes or the introduction of vulnerabilities. Disabling it ensures that deployments are controlled and reviewed.</li> <li>Disable stack tracing: Disabling stack traces prevents the disclosure of internal application details during errors, protecting sensitive information.</li> <li>Why it matters: Ensures controlled deployments and prevents information leakage.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit <code>server</code>: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Modify the <code>&lt;Host&gt;</code> block to disable <code>autoDeploy</code> and <code>deployOnStartup</code>: <pre><code>&lt;Host name=\"localhost\"  appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"false\" deployOnStartup=\"false\"&gt;\n</code></pre></p> </li> <li> <p>Disable stack traces in error pages (<code>web.xml</code>): <pre><code>&lt;error-page&gt;\n        &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;\n        &lt;location&gt;/error.jsp&lt;/location&gt; \n&lt;/error-page&gt;\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#15-harden-the-shutdown-port", "title": "15. Harden the shutdown port", "text": "<p>The shutdown port allows Tomcat to be stopped remotely. Disabling this port or restricting access ensures that attackers cannot shut down your server unexpectedly.</p> <ul> <li>Why it matters: Prevents unauthorised shutdown of Tomcat, ensuring continuous availability.</li> </ul> <p>How-to</p> <ul> <li> <p>Edit <code>server.xml</code>: <pre><code>sudo nano /opt/tomcat/conf/server.xml\n</code></pre></p> </li> <li> <p>Set the shutdown port to <code>-1</code> to disable it: <pre><code>&lt;Server port=\"-1\" shutdown=\"SHUTDOWN\"&gt;\n</code></pre></p> </li> </ul>"}, {"location": "getting-started/cybersecurity-linux/#additional-recommendations", "title": "Additional Recommendations", "text": "<ol> <li>Replace the ROOT web application: It is a best practice to replace the default Tomcat ROOT web application with a custom one or remove it if not needed. The default ROOT application can expose unnecessary information.</li> <li>Use a Java Security Manager: The Java Security Manager enforces restrictions on the permissions of Java code running within Tomcat. Enabling it adds an additional layer of security by limiting what code can do.</li> <li>Set <code>failureCount</code> to 5 failed login attempts for admin accounts: This limits the number of attempts to brute-force credentials, protecting admin accounts from attacks.</li> </ol>"}, {"location": "getting-started/cybersecurity-linux/#sources", "title": "Sources", "text": "<ul> <li>https://www.stigviewer.com/stig/apache_tomcat_application_server_9/</li> <li>https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf</li> <li>https://tomcat.apache.org/tomcat-9.0-doc/security-howto.html</li> <li>https://www.openlogic.com/blog/apache-tomcat-security-best-practices</li> <li>https://knowledge.broadcom.com/external/article/226769/enable-http-strict-transport-security-hs.html*</li> </ul>"}, {"location": "getting-started/cybersecurity-win/", "title": "Security recommendations for Tomcat 9 deployments (Windows 10/11)", "text": ""}, {"location": "getting-started/cybersecurity-win/#priority-summary", "title": "Priority Summary", "text": "<ol> <li>Run Tomcat as a non-administrative user and enforce strict file permissions.</li> <li>Add TLS 1.2/1.3 with FIPS-validated ciphers and HSTS. </li> <li>Harden cookie security (HttpOnly and Secure flags).</li> <li>Enable AccessLogValve and log client IPs behind proxies.</li> <li>Patch Tomcat regularly and enable LockOutRealm.</li> <li>Remove unnecessary applications and connectors and harden the shutdown port.</li> <li>Disable auto-deployment and stack tracing.</li> <li>Audit file changes and protect the keystore.</li> </ol> <p>The rest of this guide assumes that you installed Tomcat9 as a service (https://tomcat.apache.org/download-90.cgi).</p>"}, {"location": "getting-started/cybersecurity-win/#1-run-tomcat-as-a-non-administrative-user", "title": "1. Run Tomcat as a Non-Administrative User", "text": "<p>Running Tomcat as a non-administrative user on Windows limits the damage that can occur if the Tomcat instance is compromised. By default, Tomcat runs as a system service on Windows. You should configure it to run under a less privileged user account.</p> <ul> <li>Why it matters: Minimizes privileges and limits the damage an attacker can inflict if they gain access to Tomcat.</li> </ul> <p>How-to</p> <ol> <li>Create a new local user called <code>Tomcat</code> with limited privileges.</li> <li>Ensure that the user can <code>Log as a Service</code> (Local Security Policy &gt; Logal Policies &gt; User Rights Assignment &gt; Log on as a service)</li> <li>Open the Services management console (<code>services.msc</code>).</li> <li>Locate the <code>Apache Tomcat</code> service.</li> <li>Right-click on the service and select Properties.</li> <li>Go to the Log On tab.</li> <li>Select This account, then enter the <code>Tomcat</code> account credentials.</li> <li>Restart the service.</li> </ol>"}, {"location": "getting-started/cybersecurity-win/#2-set-proper-file-permissions", "title": "2. Set proper file permissions", "text": "<p>Proper file permissions ensure only authorized users can access or modify critical Tomcat files. On Windows, this involves setting file permissions using the Security tab in the file properties.</p> <ul> <li>Why it matters: Prevents unauthorized access or modification of Tomcat\u2019s critical configuration files and logs.</li> </ul> <p>How-to</p> <ol> <li>Navigate to the Tomcat installation directory (<code>%CATALINA_HOME%</code>), typically <code>C:\\Program Files\\Apache Software Foundation\\Tomcat 9.0</code>.</li> <li>Right-click on the conf, bin, logs, webapps, and temp folders and select Properties.</li> <li>Go to the Security tab and assign the following permissions:</li> <li>TomcatUser: Full Control for logs, temp, work, and webapps. </li> <li>Administrators: Full Control for conf and bin. </li> <li>Others: Read and execute only.</li> </ol>"}, {"location": "getting-started/cybersecurity-win/#3-add-tls-v12-or-v13-with-fips-validated-ciphers", "title": "3. Add TLS v1.2 or v1.3 with FIPS-validated ciphers", "text": "<p>TLS (Transport Layer Security) is essential for encrypting data transmitted between clients and servers. By enforcing TLS 1.2 or 1.3 with strong, FIPS-validated ciphers, you ensure secure communication that meets strict compliance standards.</p> <ol> <li>Open the <code>server.xml</code> file located in <code>%CATALINA_HOME%\\conf\\server.xml</code>.</li> <li>Add or modify the SSL connector: <pre><code>&lt;Connector port=\"8443\" protocol=\"org.apache.coyote.http11.Http11NioProtocol\"\n           maxThreads=\"150\" SSLEnabled=\"true\"&gt;\n   &lt;SSLHostConfig&gt;\n      &lt;Protocols&gt;\n         &lt;TLSv1.2 /&gt;\n         &lt;TLSv1.3 /&gt;\n      &lt;/Protocols&gt;\n      &lt;Cipher&gt;TLS_AES_128_GCM_SHA256, TLS_AES_256_GCM_SHA384, TLS_CHACHA20_POLY1305_SHA256&lt;/Cipher&gt;\n      &lt;Certificate certificateKeyFile=\"conf/server.key\"\n                   certificateFile=\"conf/server.crt\"\n                   certificateChainFile=\"conf/chain.crt\"\n                   type=\"RSA\" /&gt;\n   &lt;/SSLHostConfig&gt;\n&lt;/Connector&gt;\n</code></pre></li> <li>Restart the service</li> </ol>"}, {"location": "getting-started/cybersecurity-win/#4-add-http-strict-transport-security-hsts", "title": "4. Add HTTP Strict Transport Security (HSTS)", "text": "<p>HSTS instructs browsers to only interact with your server using HTTPS. It prevents downgrade attacks where an attacker could force a user to connect via HTTP. Once a browser receives the HSTS header, it will automatically convert all future requests to HTTPS, ensuring secure communication.</p> <ul> <li>Why it matters: Protects against protocol downgrade attacks and ensures that all communications use HTTPS.</li> </ul> <p>How-to</p> <ol> <li>Open the <code>web.xml</code> file in <code>%CATALINA_HOME%\\conf\\web.xml</code>.</li> <li>Change the filter values :</li> </ol> <pre><code>&lt;filter&gt;\n    &lt;filter-name&gt;HSTSFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.catalina.filters.HttpHeaderSecurityFilter&lt;/filter-class&gt; \n    &lt;init-param&gt; \n        &lt;param-name&gt;hstsEnabled&lt;/param-name&gt;\n        &lt;param-value&gt;true&lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;init-param&gt; \n        &lt;param-name&gt;hstsMaxAgeSeconds&lt;/param-name&gt; \n        &lt;param-value&gt;31536000&lt;/param-value&gt; \n    &lt;/init-param&gt; \n&lt;/filter&gt; \n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;HSTSFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre> <p>Restart the <code>Tomcat</code> service</p>"}, {"location": "getting-started/cybersecurity-win/#5-disable-x-powered-by-header", "title": "5. Disable X-Powered-By Header", "text": "<p>By default, Tomcat may expose the <code>X-Powered-By</code> header, which discloses information about the server and its version. Disabling this prevents attackers from easily identifying the version of Tomcat being used, reducing the risk of targeted attacks based on known vulnerabilities.</p> <ul> <li>Why it matters: Hides unnecessary information from potential attackers and reduces the risk of exploit-based attacks.</li> </ul> <p>How-to</p> <ol> <li>Open the <code>server.xml</code> file in <code>%CATALINA_HOME%\\conf\\server.xml</code>.</li> <li>Change file permissions:</li> </ol> <pre><code>&lt;Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showReport=\"false\" showServerInfo=\"false\" /&gt;\n</code></pre> <p>And restart the <code>Tomcat</code> service.</p>"}, {"location": "getting-started/cybersecurity-win/#6-harden-cookie-security-httponly-secure-flags", "title": "6. Harden Cookie Security (HttpOnly &amp; Secure flags)", "text": "<ul> <li>HttpOnly flag: Ensures that cookies cannot be accessed via JavaScript, protecting them from cross-site scripting (XSS) attacks.</li> <li>Secure flag: Ensures that cookies are only transmitted over HTTPS, preventing them from being exposed during plaintext transmission.</li> <li>Why it matters: Protects session cookies from being stolen or accessed by malicious scripts.</li> </ul> <p>How-to</p> <ol> <li>Open <code>web.xml</code> in <code>%CATALINA_HOME%\\conf\\web.xml</code>.</li> <li>Set the cookie properties:</li> </ol> <pre><code>&lt;session-config&gt;\n    &lt;cookie-config&gt;\n        &lt;http-only&gt;true&lt;/http-only&gt;\n        &lt;secure&gt;true&lt;/secure&gt;\n    &lt;/cookie-config&gt;\n&lt;/session-config&gt;\n</code></pre>"}, {"location": "getting-started/cybersecurity-win/#7-enable-accesslogvalve-for-each-virtual-host", "title": "7. Enable AccessLogValve for each virtual host", "text": "<p>Configuring AccessLogValve for each virtual host in Tomcat allows you to log incoming requests for auditing and troubleshooting purposes. These logs provide valuable insights into who is accessing the server and can help detect potential malicious activity.</p> <ul> <li>Why it matters: Provides detailed logs for auditing, forensics, and detecting suspicious activity.</li> </ul> <p>How-to</p> <ol> <li>Open <code>server.xml</code> in <code>%CATALINA_HOME%\\conf\\server.xml</code>.</li> <li>Change file permissions:</li> </ol> <pre><code>&lt;Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"false\" autoDeploy=\"false\"&gt;\n&lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\nprefix=\"localhost_access_log\" suffix=\".txt\"\npattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n&lt;/Host&gt;\n</code></pre>"}, {"location": "getting-started/cybersecurity-win/#8-regularly-patch-tomcat-for-security-vulnerabilities", "title": "8. Regularly patch Tomcat for security vulnerabilities", "text": "<p>Tomcat, like any other software, can have security vulnerabilities. Regularly applying patches and updates ensures that your installation is protected against known threats. It\u2019s crucial to stay up to date with the latest security patches to mitigate risks.</p> <ul> <li>Why it matters: Fixes known vulnerabilities and prevents attackers from exploiting outdated software.</li> </ul>"}, {"location": "getting-started/cybersecurity-win/#9-use-lockoutrealm-to-prevent-brute-force-attacks", "title": "9. Use LockOutRealm to prevent brute-force attacks", "text": "<p>The LockOutRealm helps prevent brute-force login attacks by locking out users after a set number of failed login attempts. Configuring this for admin accounts is particularly important.</p> <ul> <li>Why it matters: Prevents attackers from brute-forcing admin credentials.</li> </ul> <p>How-to</p> <ol> <li>Open <code>server.xml</code> in <code>%CATALINA_HOME%\\conf\\server.xml</code>.</li> <li>Add <code>failureCount</code> et <code>lockOutTime</code>:</li> </ol> <p><pre><code>&lt;Realm className=\"org.apache.catalina.realm.LockOutRealm\" failureCount=\"5\" lockOutTime=\"600\"&gt;\n  &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n         resourceName=\"UserDatabase\"/&gt;\n&lt;/Realm&gt;\n</code></pre> 3. Restart the <code>Tomcat</code> service</p>"}, {"location": "getting-started/cybersecurity-win/#10-secure-the-keystore-file", "title": "10. Secure the keystore file", "text": "<p>The keystore contains sensitive information, such as private keys used for SSL/TLS. Ensuring that the keystore file is properly protected by strict file permissions and password protection prevents unauthorized access to critical security credentials.</p> <ul> <li>Why it matters: Protects sensitive private keys from unauthorized access or tampering.</li> </ul> <p>How-to</p> <ol> <li>Right-click on the keystore file and select Properties.</li> <li>Go to the Security tab.</li> <li>Ensure only the <code>Tomcat</code> user has access, and set the permissions to Read and Execute.</li> </ol>"}, {"location": "getting-started/cybersecurity-win/#11-disable-auto-deployment-and-stack-tracing", "title": "11. Disable Auto-Deployment and Stack Tracing", "text": "<p>Auto-deployment introduces security risks by allowing new applications to be deployed without manual intervention. Disabling stack traces prevents attackers from seeing sensitive system information.</p> <ul> <li>Why it matters: Prevents unauthorized deployments and hides sensitive details during errors.</li> </ul> <p>How-to</p> <ol> <li>Open <code>server.xml</code> in <code>%CATALINA_HOME%\\conf\\server.xml</code>.</li> <li>Modify the <code>&lt;Host&gt;</code> block and add the auditing rules:</li> </ol> <p><pre><code>&lt;Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"false\" deployOnStartup=\"false\"&gt;\n</code></pre> 3. To disable stack traces, open <code>web.xml</code> in <code>%CATALINA_HOME%\\conf\\web.xml</code> and add: <pre><code>&lt;error-page&gt;\n   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;\n   &lt;location&gt;/error.jsp&lt;/location&gt;\n&lt;/error-page&gt;\n</code></pre></p>"}, {"location": "getting-started/cybersecurity-win/#12-remove-unnecessary-applications-and-connectors", "title": "12. Remove unnecessary applications and connectors", "text": "<ul> <li>Remove folders: Unused folders such as <code>documentation</code>, <code>examples</code>, <code>manager</code>, and <code>host-manager</code> should be deleted from the production environment to minimize the attack surface.</li> <li>Remove unused connectors: Disable and remove any unused connectors (e.g., HTTP connector) to reduce exposure to attacks.</li> <li>Why it matters: Minimizes the attack surface and reduces potential entry points for attackers.</li> <li>Disable unused connectors in <code>server.xml</code></li> </ul>"}, {"location": "getting-started/cybersecurity-win/#13-harden-the-shutdown-port", "title": "13. Harden the shutdown port", "text": "<p>The shutdown port allows Tomcat to be stopped remotely. Disabling this port or restricting access ensures that attackers cannot shut down your server unexpectedly.</p> <ul> <li>Why it matters: Prevents unauthorised shutdown of Tomcat, ensuring continuous availability.</li> </ul> <p>How-to</p> <ol> <li>Open <code>server.xml</code> in <code>%CATALINA_HOME%\\conf\\server.xml</code>.</li> <li>Set the shutdown port to <code>-1</code> to disable it:</li> </ol> <p><pre><code>&lt;Server port=\"-1\" shutdown=\"SHUTDOWN\"&gt;\n&lt;/Server&gt;\n</code></pre> You can also set the port to <code>-1</code> during the installation of the service.</p>"}, {"location": "getting-started/cybersecurity-win/#additional-recommendations", "title": "Additional Recommendations", "text": "<ol> <li>Replace the ROOT web application: It is a best practice to replace the default Tomcat ROOT web application with a custom one or remove it if not needed. The default ROOT application can expose unnecessary information.</li> <li>Use a Java Security Manager: The Java Security Manager enforces restrictions on the permissions of Java code running within Tomcat. Enabling it adds an additional layer of security by limiting what code can do.</li> <li>Set <code>failureCount</code> to 5 failed login attempts for admin accounts: This limits the number of attempts to brute-force credentials, protecting admin accounts from attacks.</li> </ol>"}, {"location": "getting-started/cybersecurity-win/#sources", "title": "Sources", "text": "<ul> <li>https://www.stigviewer.com/stig/apache_tomcat_application_server_9/</li> <li>https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf</li> <li>https://tomcat.apache.org/tomcat-9.0-doc/security-howto.html</li> <li>https://www.openlogic.com/blog/apache-tomcat-security-best-practices</li> <li>https://knowledge.broadcom.com/external/article/226769/enable-http-strict-transport-security-hs.html</li> </ul>"}, {"location": "getting-started/install/", "title": "Install", "text": ""}, {"location": "getting-started/install/#software-prerequisites", "title": "Software prerequisites", "text": "<ul> <li>64-bit Windows or Linus operating system</li> <li>Java 17 (Oracle or OpenJDK full version, not Headless)</li> <li>PostgreSQL 13 or above (Extract may work with older versions that are not supported anymore)</li> <li>Tomcat 9 (Extract is not currently compatible with Tomcat 10 due to the use of SpringBoot 2)</li> <li>A \u201cmodern\u201d web browser (&lt;2 years old) to access the application</li> </ul>"}, {"location": "getting-started/install/#installation", "title": "Installation", "text": "<p>Info</p> <p>In the given paths, [ZIP] indicates the root of the delivered ZIP file in the release assets. Otherwise, relative paths are expressed in relation to the directory in which the application is deployed.</p> <p>Tip</p> <p>The latest release can be downloaded here.</p> <ol> <li>Create a PostgreSQL database to store the application data. Encoding must be UTF-8.</li> <li>The database must be accessible by a user with read, write and object creation/deletion privileges. The database content is automatically generated when the application is first started.</li> <li>Deploy the <code>[ZIP]\\application\\extract##x.x.x.war</code> file to Tomcat server. It is normal for any automatic start-up of the application after deployment to fail.</li> <li>In the folder of the deployed application, go to the <code>WEB-INF\\classes</code> directory and modify the <code>application.properties</code> file.</li> <li> <p>Modify the database connection properties:</p> <ul> <li>spring.datasource.url : JDBC database connection string</li> <li>spring.datasource.username : Database user name</li> <li>spring.datasource.password : Database user password</li> </ul> </li> <li> <p>(Optional) By default, Extract is in french but you can set it in german or in multilingual mode (french and german). In multilingual mode, users can choose their language preference. To do that, you must change the <code>extract.i18n.language</code> property in the <code>application.properties</code> file. The value must be the ISO code of the desired language (e.g. <code>de</code>). To set it up in multilingual mode, all languages ISO codes must be given separated by comma. The first one acts as the default language (e.g. for fallback, creation of first user, etc.). Here are a couple of examples :</p> <ul> <li><code>extract.i18n.language=fr</code> Extract is in french</li> <li><code>extract.i18n.language=de</code> Extract is in german</li> <li><code>extract.i18n.language=fr,de</code> Extract is in french and german, french being the default language</li> </ul> <p>To add a new language, please refer to Add a new language section.</p> </li> <li> <p>Enter the application URL using the <code>application.external.url</code> property. The value of this property is used to generate links in notification e-mails.</p> </li> <li>Enter a random 32-character ISO-8859-1 string for <code>database.encryption.secret</code> and <code>database.encryption.salt</code> properties. These strings are used as keys to encrypt certain database values.</li> <li>Save the file.</li> <li>In the same folder, log properties can be defined in the <code>logback-spring.xml</code> file.</li> <li>Start the application. </li> <li>Connect to the database. </li> <li>Execute the <code>[ZIP]\\sql\\update_db.sql</code> script to apply any database schema modifications that are not automatically performed by the application.</li> <li> <p>Connect to the application. When logging in for the first time, the user must create an admin account:</p> <p></p> <p>If the application is in multilingual mode, the language preference of the admin user will be the language of the browser, if it exists in the Extract languages. If not, it will be the default language of Extract. The language can be changed later on (see Current user administration).</p> </li> <li> <p>Fill in the fields and click <code>Cr\u00e9er le compte</code>.</p> </li> <li>Go to <code>Param\u00e8tres</code>.</li> <li>Enter the storage path. This is the directory in which data relating to request processing will be written. The Tomcat user must therefore have read and write rights to this directory.</li> <li>Enter SMTP server parameters for sending notifications.</li> <li>Click on <code>Enregistrer</code>.</li> <li>Congratulation ! The application is now operational.</li> </ol>"}, {"location": "getting-started/install/#application-update", "title": "Application Update", "text": "<p>If you already have a previous version of the application installed, please follow the procedure below.</p> <ol> <li> <p>Back-up the following files so you don't have to redefine your configuration:</p> <ul> <li><code>WEB-INF\\classes\\application.properties</code></li> <li><code>WEB-INF\\classes\\logback-spring.xml</code></li> <li><code>WEB-INF\\classes\\static\\js\\requestMap\\map.custom.js</code> (if you've set it)</li> <li><code>WEB-INF\\classes\\templates\\email\\html\\*</code> (if you've customized the e-mail templates)</li> <li><code>WEB-INF\\classes\\static\\lang\\*\\message.properties</code></li> </ul> </li> <li> <p>Undeploy the existing Extract application.</p> </li> <li>For Tomcat on Windows: go to the directory where Tomcat is installed and delete all directories named <code>[digit]-extract</code> (e.g. <code>0-extract</code>, <code>1-extract</code>,...) under the <code>temp</code> sub-directory.</li> <li>Deploy the new WAR.</li> <li> <p>Compare the <code>WEB-INF\\classes\\application.properties</code> file with the one you backed-up, and transfer any new or modified properties to the latter.</p> <p>Updating to version 2.1</p> <p>Enter a random 32-character ISO-8859-1 string for <code>database.encryption.secret</code> and <code>database.encryption.salt</code> properties. These strings are used as keys to encrypt certain database values.</p> </li> <li> <p>Overwrite the folowing file with your backup :</p> <ul> <li><code>WEB-INF\\classes\\logback-spring.xml</code></li> </ul> </li> <li> <p>Copy your backup <code>map.custom.js</code> file (if set) to the <code>WEB-INF\\classes\\static\\js\\requestMap</code> directory.</p> <p>Updating to version 2.1</p> <p>The OpenLayers library used to display the map underwent a major update (to 9.1.0) when Extract was upgraded to version 2.1. The code used to register a projection system has changed (see the new version of the <code>map.custom.js</code> example file). Depending on the functionality used, further modifications may be necessary. Please refer to the official documentation if necessary: https://openlayers.org/en/v9.1.0/apidoc/</p> </li> <li> <p>Compare the e-mail templates in <code>WEB-INF\\classes\\templates\\email\\html\\</code> with those you've backed up, to merge any changes you've made with the new version.</p> </li> <li>Compare the language files in <code>WEB-INF\\classes\\static\\lang\\*\\</code> with those you've backed up, to merge any changes you've made with the new version.</li> <li>Restart the Tomcat Extract application to take account of the updated configuration files.</li> <li>Connect to the database.</li> <li>Run the <code>[ZIP]\\sql\\update_db.sql</code> script to apply any changes to the structure that are not made automatically by the application.</li> </ol>"}, {"location": "getting-started/install/#server-migration", "title": "Server Migration", "text": "<p>Info</p> <p>The procedure below details how to proceed if the application needs to be migrated to other servers.</p>"}, {"location": "getting-started/install/#actions-on-the-old-server", "title": "Actions on the old server", "text": "<ol> <li>Make a backup of the directory containing current processing data. The path of this directory is defined in the application parameters (<code>Param\u00e8tres</code> &gt; <code>Emplacement des fichiers temporaires</code>).</li> <li>Make a backup of the configuration and customization files as per step 1 in the Application Update section.</li> <li>If the database is also being migrated, make a dump of the Extract database.</li> </ol>"}, {"location": "getting-started/install/#actions-on-the-new-server", "title": "Actions on the new server", "text": "<ol> <li>If the database has also been migrated, restore the Extract database dump.</li> <li>Restore backup of current processing data.</li> <li>Follow the update procedure from step 4</li> <li>If the path to the folder containing the current processing data has changed, don't forget to modify it in the application (<code>Param\u00e8tres</code> &gt; <code>Emplacement des fichiers temporaires</code>).  </li> </ol>"}, {"location": "getting-started/network-integration/", "title": "Integrate Extract in your network", "text": ""}, {"location": "getting-started/network-integration/#web-interface-internal-vs-exposed", "title": "Web interface - Internal vs exposed", "text": "<p>Extract can be exposed to the Internet. But if all Operators and Administrators are on your internal network, Extract can resides on your LAN and does not need to be exposed on the Internet.</p>"}, {"location": "getting-started/network-integration/#connectors-get-order-and-send-results", "title": "Connectors (Get order and send results)", "text": "<p>To get orders and return responses with files, extract uses \"Connectors\". The default connector (easySDI v4) is used to interact with viageo.ch API. The connector uses <code>HTTP GET</code> to get orders, and <code>HTTP POST</code> to sent responses with files and remarks. It always acts as an HTTP client, and does not need to be exposed to internet. Authentication is done by BASIC AUTH. All traffic to viageo is TLS encrypted.</p>"}, {"location": "getting-started/network-integration/#use-network-shares", "title": "Use network shares", "text": "<p>If you store files on network drives (Scripts, archive files, etc..) you must run Tomcat service with a user that has access rights on the desired share. See Tomcat user access rights</p>"}, {"location": "how-to/extract-viageo/", "title": "Connect Extract to viageo.ch", "text": "<p>Warning</p> <p>This section is only useful if your organization provides geodata on the platform viageo.ch or plans-reseaux.ch. You must be an ASIT member to distribute geodata through these platforms.</p> <p>Info</p> <p>If you want to test the connection to a non productive instance of viageo.ch, you can use the validation instance. See viageo.ch Validation Instance</p> <p>This section explains how to connect Extract to the data portal viageo.ch, to read requests from the platform and send back extracted geodata to it. </p>"}, {"location": "how-to/extract-viageo/#configure-your-resources-on-viageoch", "title": "Configure your resources on viageo.ch", "text": "<ol> <li>Log in to your viageo.ch account.</li> <li>Go to your ressources (<code>Diffuser</code> tab &gt; <code>Mes ressources</code>)</li> <li> <p>For each geodata you want to distribute via Extract, go to edit mode and set the <code>Traitement</code> parameter to <code>Automatique</code> under the <code>Commande en ligne</code> section.</p> <p></p> </li> </ol>"}, {"location": "how-to/extract-viageo/#configure-a-connector-on-extract", "title": "Configure a connector on Extract", "text": "<ol> <li>Log in to your Extract instance with an administrator role</li> <li>Create a new EasySDI v4 connector (see Admin guide &gt; Connectors)</li> <li> <p>The <code>URL du service</code>, <code>Login distant</code> and <code>Mot de passe</code> parameters can be found on viageo.ch under <code>Diffuser</code> &gt; <code>Automatiser le processus</code></p> <p>Warning</p> <p>These parameters are only accessible for the main account of your viageo.ch organization.</p> </li> </ol>"}, {"location": "how-to/extract-viageo/#configure-a-process-and-link-it-to-viageo-resource", "title": "Configure a process and link it to viageo resource", "text": "<ol> <li>Usually, you want to create one process by resource from viageo.ch. The process will be in charge of extracting the corresponding geodata. To create a new process see Processes.</li> <li> <p>Once the process is created, create a new connector's rule (see Connector rules) to connect the process to the corresponding resource from viageo.ch. To do that, the rule syntax is the following:</p> <pre><code>productguid == \"viageo resource id\" \n</code></pre> <p>Info</p> <p>Viageo resources id can be found on viageo.ch under <code>Diffuser</code> &gt; <code>Automatiser le processus</code> (only accessible for the main account of your organization) in the resources list. </p> <p></p> </li> </ol> <p> </p>"}, {"location": "how-to/fme-flow/", "title": "Set up an extraction using FME Flow (Server)", "text": "<p>Info</p> <p>This tutorial uses the extraction plugin <code>Extraction FME Flow (Version 2)</code> which allows unlimited parameters length, thus allowing request with precise geometries like municipalities boundary.</p> <p>To follow along with this tutorial, download the sample script and data available here. Either by cloning the repo :</p> <pre><code>git clone https://github.com/asit-asso/extraction-samples.git\n</code></pre> <p>Or downloading a ZIP archive with the following link : https://github.com/asit-asso/extraction-samples/archive/refs/heads/main.zip</p>"}, {"location": "how-to/fme-flow/#set-up-the-fme-workspace-inside-fme-flow", "title": "Set up the FME workspace inside FME Flow", "text": "<ol> <li> <p>In the downloaded folder, go to the subfolder <code>fme</code> and open up the <code>sample-script-FME2024.fmw</code> FME workspace. This tutorial uses the same workspace as the previous tutorial for FME Form.</p> </li> <li> <p>First, we need to uncheck the <code>required</code> option of the <code>parametersFile</code> User Parameter in order to let FME Flow override the <code>parameters.json</code>.</p> <p></p> </li> <li> <p>Then, connect to your FME Flow instance.</p> <p></p> </li> <li> <p>Next, publish the workspace to FME Flow</p> <p></p> <p>Choose a valid FME Flow connection and create a new repository where to publish the workspace, e.g. <code>extract</code> or use an existing one.</p> <p></p> </li> <li> <p>Make sure the <code>Upload data files</code> option is checked ans select only the <code>swissTLMRegio_Buildings_2056.zip</code> file. Indeed, the latter is our business data to be extracted and must be uploaded to FME Flow. But the <code>parameters.json</code> file can be omitted since the parameters will be overridden by the <code>FME Data Download</code> body request (see below).</p> <p></p> </li> <li> <p>The <code>Extraction FME Flow (Version 2)</code> plugin sends all request parameters encoded as a <code>GeoJSON</code> through the body of the <code>FME Data Download</code> POST request. To tell FME to use the request's body as GeoJSON input for the <code>FeatureReader</code>, we need to do the following : </p> <ul> <li>In the last dialog, select the <code>Data Download</code> Service. </li> <li>Click on the edit button and under <code>Send HTTP Message Body to Reader</code>, select the GeoJSON Reader (in our case, this is the <code>FeatureReader</code> \"Read_Parameters\"). </li> <li> <p>Under <code>Writers in Download</code>, select all available writers. Therefore, data outputted in all formats will be available in the Data Download Service response.</p> <p></p> </li> </ul> </li> <li> <p>Once we have uploaded the workspace and the necessary data to FME Flow, we need to create an API token to authenticate the request that will be posted by Extract.</p> <p>In FME Flow, under Workspaces, go to your extract repository. Select the corresponding workspace (<code>sample-script-FME2024.fmw</code> in our example). Under the <code>Advanced</code> tab, click on <code>Create a Webhook</code>.</p> <p></p> <p>In the next dialog, make sure the <code>User Can Upload</code> option is checked and click on <code>Create</code>.</p> <p>In the next dialog, click on <code>Download Webhook</code>. This will download a text file with the URL to call the request and the API token to authenticate it. This is the only chance you get to retrieve these information !</p> <p></p> </li> <li> <p>In the downloaded text file, write down the URL to call the <code>FME Data Download Service</code> without the query parameters and the API token.</p> <p></p> </li> </ol>"}, {"location": "how-to/fme-flow/#connect-the-workspace-to-extract", "title": "Connect the workspace to Extract", "text": "<ol> <li> <p>In Extract, create a new or use an existing process (see processes).</p> </li> <li> <p>Drag and drop the task plugin <code>Extraction FME Flow (Version 2)</code> into the process task list.</p> </li> <li> <p>In the field <code>URL du service FME Server Data Download</code>, type the URL of your service. In the field <code>Token API FME</code>, type the API token.</p> <p></p> </li> <li> <p>To test the extraction, you can link this process to viageo (see Connect Extract to viageo.ch). With our example, the linked resource can be orderable over the entire Switzerland in the following format : <code>shapefile</code>, <code>geopackage</code>, <code>GeoJSON</code> and <code>DXF</code>. </p> </li> <li> <p>Finally, you can order the linked product on viageo, Extract will retrieve the request and run the FME workspace by calling the FME Flow Data Download Service with all request parameters carried out in API request's body.</p> </li> </ol> <p> </p>"}, {"location": "how-to/fme-form/", "title": "Set up an extraction using FME Form (desktop)", "text": "<p>Info</p> <p>This tutorial uses the extraction plugin <code>FME Form (Version 2)</code> which allows unlimited parameters length, thus allowing request with precise geometries like municipalities boundary.</p> <p>To follow along with this tutorial, download the sample script and data available here. Either by cloning the repo :</p> <pre><code>git clone https://github.com/asit-asso/extraction-samples.git\n</code></pre> <p>Or downloading a ZIP archive with the following link : https://github.com/asit-asso/extraction-samples/archive/refs/heads/main.zip</p>"}, {"location": "how-to/fme-form/#set-up-the-fme-workspace", "title": "Set up the FME workspace", "text": "<ol> <li> <p>In the downloaded folder, go to the subfolder <code>fme</code> and open up the <code>sample-script-FME2024.fmw</code> FME workspace.</p> </li> <li> <p>The workspace uses a <code>creator</code> as a starting point.</p> </li> <li> <p>The <code>FME Form (Version 2)</code> plugin sends all request parameters in a <code>GeoJSON</code> file. The latter is given as a CLI argument when running the workspace where the key is <code>--parametersFile</code> and the value is the path of the <code>GeoJSON</code> file. </p> <p>To tell FME to use this argument, we need to create a User Parameter : </p> <p>Under <code>User Parameters</code>, create a new <code>File/Folder/URL</code> parameter. The identifier must be <code>parametersFile</code>. For convenience, you can allocate a default value <code>$(FME_MF_DIR)\\parameters.json</code> to the parameter. Thus, when run inside FME, the default value is taken and a local GeoJSON file is used. But when run by Extract, the <code>parametersFile</code> will be overridden by the CLI argument and the GeoJSON from Extract will be used.</p> <p></p> </li> <li> <p>Then we need to read the <code>GeoJSON</code> file with a <code>FeatureReader</code>. The format is <code>GeoJSON</code> and the dataset is the <code>$(parametersFile)</code> parameter. The feature of the <code>GeoJSON</code> file is the request perimeter and can be use to extract or clip data. All other attributes are the request parameters.</p> <p></p> </li> <li> <p>Before reading your actual data, you can set global variables from the GeoJSON attributes like the FolderOut (to know where to save the output data), the desired Format and CRS using a <code>VariableSetter</code> transformer. Thus, it will be possible to use them later after reading your business data.</p> <p></p> </li> <li> <p>Then you can read your business data with a <code>FeatureReader</code> transformer. In our example, we use the feature from the GeoJSON parameters file (request's perimeter) to read only the data that intersect with it.</p> <p></p> </li> <li> <p>Once your data are read, you can retrieve the previously set variables to know for example in which format and CRS the client wants the data.</p> <p></p> </li> <li> <p>Reproject the data accordingly and save them in the given format. Remember, the data must be saved in the <code>FolderOut</code> parameter given in the <code>GeoJSON</code> file.</p> <p></p> </li> </ol>"}, {"location": "how-to/fme-form/#connect-the-workspace-to-extract", "title": "Connect the workspace to Extract", "text": "<ol> <li> <p>In Extract, create a new or use an existing process (see processes).</p> </li> <li> <p>Drag and drop the task plugin <code>Extraction FME Form (Version 2)</code> into the process task list.</p> </li> <li> <p>In the field <code>Chemin du workspace FME</code>, type the path where your FME workspace is. In the field <code>Chemin du programme FME (fme.exe)</code>, type the path where your FME executable is. In the field <code>Nombre de fme.exe lanc\u00e9s par ce workspace (d\u00e9faut = 1, max = 8)</code>, type the number of FME executable needed in parallel for your workspace (for our example, only one is needed).</p> <p></p> </li> <li> <p>To test the extraction, you can link this process to viageo (see Connect Extract to viageo.ch). With our example, the linked resource can be orderable over the entire Switzerland in the following format : <code>shapefile</code>, <code>geopackage</code>, <code>GeoJSON</code> and <code>DXF</code>. </p> </li> <li> <p>Finally, you can order the linked product on viageo, Extract will retrieve the request and run the FME workspace with all request parameters carried out in the GeoJSON parameters file.</p> </li> </ol> <p> </p>"}, {"location": "how-to/python/", "title": "Set up an extraction using Python", "text": "<p>Info</p> <p>This tutorial uses the extraction plugin <code>Extraction Python</code> that allows you to run a custom Python script. A functional Python interpreter for the script (version, dependencies, etc.) must be provided.</p> <p>To follow along with this tutorial, you can download the sample script and data available here. Either by cloning the repo :</p> <pre><code>git clone https://github.com/asit-asso/extraction-samples.git\n</code></pre> <p>Or downloading a ZIP archive with the following link : https://github.com/asit-asso/extraction-samples/archive/refs/heads/main.zip</p> <p>In the subfolder <code>python</code>, you will find a Python script example <code>main.py</code>, data to extract <code>inputData.gpkg</code> and a parameters GeoJSON file example <code>parameters.json</code>.</p> <p>Warning</p> <p>In addition to Python 3, this example uses a third party OGR2OGR executable. The latter must be installed and available on your system if you want to make the example work.</p>"}, {"location": "how-to/python/#set-up-the-python-script", "title": "Set up the Python script :", "text": "<ol> <li> <p>First we need to import necessary Python packages to run the script. All used packages are provided by the standard python distribution, so ne need to install them.</p> <pre><code>import subprocess\nimport json\nimport os\nimport sys\n</code></pre> </li> <li> <p>Then we setup 2 global variables, the path where the business data to extract are saved and the path of the OGR2OGR executable tu use. All paths can be absolute or relative to the Python script that will be run.</p> <pre><code>OGR2OGR_PATH = \"C:\\\\OSGeo4W\\\\bin\\\\ogr2ogr.exe\"\nINPUT_DATA = \"inputData.gpkg\"\n</code></pre> </li> <li> <p>The Python extraction plugin sends all request parameters in a <code>GeoJSON</code> file. The path of the latter is given as the first CLI argument when running the python script.</p> <p>Therefore, the Python script must retrieve this parameters file by reading the CLI argument and opening and parsing the <code>GeoJSON</code> file.</p> <pre><code># Get parameters file path from command line argument\nparameters_file = sys.argv[1]\n\n# Read and parse the parameters.json file\nwith open(parameters_file, \"r\", encoding=\"utf-8\") as json_file:\n    parameters = json.load(json_file)\n</code></pre> <p>Once done, all request parameters are available in the <code>parameters</code> variable as a python dictionary.</p> </li> <li> <p>Since our business data are in <code>EPSG:2056</code>, we need to reproject the parameters file from <code>EPSG:4326</code> to <code>EPSG:2056</code> in order to use it to clip our data. We will save it as a temporary <code>clipper.geojson</code> file in FolderOut.</p> <pre><code>cmd = [\n    OGR2OGR_PATH,\n    \"-s_srs\",\n    \"EPSG:4326\",\n    \"-t_srs\",\n    \"EPSG:2056\",\n    os.path.join(\n        parameters[\"properties\"][\"FolderOut\"],\n        \"clipper.geojson\"\n    ),\n    parameters_file\n]\n\n# Run the ogr2ogr command while catching and raising errors\ntry:\n    subprocess.check_output(cmd)\nexcept subprocess.CalledProcessError as e:\n    print(\"Processing parameters file failed\")\n    raise subprocess.CalledProcessError(1, cmd) from e\n</code></pre> </li> <li> <p>Before running the last OGR2OGR command, we need to translate the format and projection from the parameters file into the GDAL vocabulary.</p> <pre><code># Translate format to OGR format name\nif parameters[\"properties\"][\"Parameters\"][\"FORMAT\"] == \"GEOJSON\":\n    format = \"GeoJSON\"\nelif parameters[\"properties\"][\"Parameters\"][\"FORMAT\"] == \"GPKG\":\n    format = \"GPKG\"\nelif parameters[\"properties\"][\"Parameters\"][\"FORMAT\"] == \"DXF\":\n    format = \"DXF\"\n\n# Translate Projection to OGR CRS name\nif parameters[\"properties\"][\"Parameters\"][\"PROJECTION\"] == \"SWITZERLAND95\":\n    output_proj = \"EPSG:2056\"\nelif parameters[\"properties\"][\"Parameters\"][\"PROJECTION\"] == \"SWITZERLAND\":\n    output_proj = \"EPSG:21781\"\nelse:\n    output_proj = \"EPSG:2056\"\n</code></pre> </li> <li> <p>We can now run the final OGR2GR command to extract the data. The command will clip, reproject and save the data into FolderOut.</p> <pre><code>cmd = [\n    OGR2OGR_PATH,\n    \"-s_srs\",\n    \"EPSG:2056\",\n    \"-t_srs\",\n    output_proj,\n    \"-clipsrc\",\n    os.path.join(\n        parameters[\"properties\"][\"FolderOut\"],\n        \"clipper.geojson\"\n    ),\n    \"-f\",\n    format,\n    os.path.join(\n        parameters[\"properties\"][\"FolderOut\"],\n        f\"result.{parameters[\"properties\"][\"Parameters\"][\"FORMAT\"].lower()}\"\n    ),\n    INPUT_DATA\n]\n\n# Run the ogr2ogr command while catching and raising errors\ntry:\n    subprocess.check_output(cmd)\nexcept subprocess.CalledProcessError as e:\n    print(\"Processing data failed\")\n    raise subprocess.CalledProcessError(1, cmd) from e\n</code></pre> </li> <li> <p>Finally, we delete the temporary <code>clipper.geojson</code> to avoid sending it to the client.</p> <pre><code>os.remove(os.path.join(\n        parameters[\"properties\"][\"FolderOut\"],\n        \"clipper.geojson\"\n    )\n)\n</code></pre> </li> </ol> <p>Here is the final Python script :</p> <pre><code>import subprocess\nimport json\nimport os\nimport sys\n\nOGR2OGR_PATH = \"C:\\\\OSGeo4W\\\\bin\\\\ogr2ogr.exe\"\nINPUT_DATA = \"inputData.gpkg\"\n\nif __name__ == \"__main__\":\n\n    # Get parameters file path from command line argument\n    parameters_file = sys.argv[1]\n\n    # Read and parse the parameters.json file\n    with open(parameters_file, \"r\", encoding=\"utf-8\") as json_file:\n        parameters = json.load(json_file)\n\n    # Reproject the parameters.json to business data CRS (EPSG:2056)\n    # and save it as a temporary clipper.geojson file in FolderOut\n    cmd = [\n        OGR2OGR_PATH,\n        \"-s_srs\",\n        \"EPSG:4326\",\n        \"-t_srs\",\n        \"EPSG:2056\",\n        os.path.join(\n            parameters[\"properties\"][\"FolderOut\"],\n            \"clipper.geojson\"\n        ),\n        parameters_file\n    ]\n\n    # Run the ogr2ogr command while catching and raising errors\n    try:\n        subprocess.check_output(cmd)\n    except subprocess.CalledProcessError as e:\n        print(\"Processing parameters file failed\")\n        raise subprocess.CalledProcessError(1, cmd) from e\n\n    # Translate format to OGR format name\n    if parameters[\"properties\"][\"Parameters\"][\"FORMAT\"] == \"GEOJSON\":\n        format = \"GeoJSON\"\n    elif parameters[\"properties\"][\"Parameters\"][\"FORMAT\"] == \"GPKG\":\n        format = \"GPKG\"\n    elif parameters[\"properties\"][\"Parameters\"][\"FORMAT\"] == \"DXF\":\n        format = \"DXF\"\n\n    # Translate Projection to OGR CRS name\n    if parameters[\"properties\"][\"Parameters\"][\"PROJECTION\"] == \"SWITZERLAND95\":\n        output_proj = \"EPSG:2056\"\n    elif parameters[\"properties\"][\"Parameters\"][\"PROJECTION\"] == \"SWITZERLAND\":\n        output_proj = \"EPSG:21781\"\n    else:\n        output_proj = \"EPSG:2056\"\n\n    # Clip, reproject and save the data in FolderOut\n    cmd = [\n        OGR2OGR_PATH,\n        \"-s_srs\",\n        \"EPSG:2056\",\n        \"-t_srs\",\n        output_proj,\n        \"-clipsrc\",\n        os.path.join(\n            parameters[\"properties\"][\"FolderOut\"],\n            \"clipper.geojson\"\n        ),\n        \"-f\",\n        format,\n        os.path.join(\n            parameters[\"properties\"][\"FolderOut\"],\n            f\"result.{parameters[\"properties\"][\"Parameters\"][\"FORMAT\"].lower()}\"\n        ),\n        INPUT_DATA\n    ]\n\n    # Run the ogr2ogr command while catching and raising errors\n    try:\n        subprocess.check_output(cmd)\n    except subprocess.CalledProcessError as e:\n        print(\"Processing data failed\")\n        raise subprocess.CalledProcessError(1, cmd) from e\n\n    # Delete temporary clipper.geojson file\n    os.remove(os.path.join(\n            parameters[\"properties\"][\"FolderOut\"],\n            \"clipper.geojson\"\n        )\n    )\n</code></pre> <p>To test the script and run it locally, you can use the given example <code>parameters.json</code> and run the following command :</p> <pre><code>python main.py parameters.json\n</code></pre>"}, {"location": "how-to/python/#connect-the-workspace-to-extract", "title": "Connect the workspace to Extract", "text": "<ol> <li> <p>In Extract, create a new or use an existing process (see processes).</p> </li> <li> <p>Drag and drop the task plugin <code>Extraction Python</code> into the process task list.</p> </li> <li> <p>In the field <code>Chemin de l'interpr\u00e9teur Python</code>, type the path of the Python interpreter you want to use. If you use a virtual environment, you can give the path of the interpreter of the virtual environment, usually something like <code>.../.venv/Scripts/python.exe</code>. In the field <code>Chemin du script python</code>, type the path of the Python script to run.</p> <p></p> </li> <li> <p>To test the extraction, you can link this process to viageo (see Connect Extract to viageo.ch). With our example, the linked resource can be orderable over the entire Switzerland in the following format : <code>geopackage</code>, <code>GeoJSON</code> and <code>DXF</code>. </p> </li> <li> <p>Finally, you can order the linked product on viageo, Extract will retrieve the request and run the FME workspace with all request parameters carried out in the GeoJSON parameters file.</p> </li> </ol> <p> </p>"}, {"location": "how-to/qgis-server-atlas/", "title": "Set up an extraction using QGIS Server (atlas print layout)", "text": "<p>Info</p> <p>This tutorial uses the extraction plugin <code>Impression Atlas QGIS Server</code> which allows you to print out a QGIS project (e.g. in <code>PDF</code>) using a standard layout size (e.g. <code>A4</code>). Since the plugin uses a <code>GetPrint</code> request, the QGIS project must be hosted on a QGIS Server instance. </p> <p>The QGIS Atlas tool allows you to use a fixed scale and a fixed layout size by using an additional vector layer containing a grid that will be used to divide your project in multiple files. Hence, when a client request your data, the plugin will intersect the desired perimeter with your grid and print out as many files as needed to cover the request's perimeter. Each file with the fixed layout size and scale.</p> <p>To follow along with this tutorial, you can download the sample script and data available here. Either by cloning the repo :</p> <pre><code>git clone https://github.com/asit-asso/extraction-samples.git\n</code></pre> <p>Or downloading a ZIP archive with the following link : https://github.com/asit-asso/extraction-samples/archive/refs/heads/main.zip</p> <p>Warning</p> <p>This tutorial uses <code>Docker</code> and <code>Docker compose</code> to quickly get a running QGIS Server. Of course, you can use your own server.</p>"}, {"location": "how-to/qgis-server-atlas/#set-up-the-qgis-project", "title": "Set up the QGIS Project :", "text": "<ol> <li> <p>In the downloaded folder, navigate to <code>qgis-atlas-server</code> &gt; <code>qgis-server</code> &gt; <code>data</code> and open up the QGIS project <code>sample.qgz</code>. This project will be hosted on a QGIS Server and be used by the plugin. </p> <p>The project contains only 2 layers, the building footprints from swissTLMRegio and the <code>Division</code> layer. The latter is our grid layer used by the Atlas tool to divide our project in multiple outputted files.</p> </li> <li> <p>First, we need to create a print layout. In this example, there is already a print layout available (the <code>atlasLayout</code> that you can open by going to <code>Project</code> &gt; <code>Layouts</code> &gt; <code>atlasLayout</code>). But you can create your own by going to <code>Project</code> &gt; <code>New Print Layout</code>, give it a name and click <code>Ok</code>.</p> </li> <li> <p>In the print compose, you can add a map, legend, scale bar, some labels etc. You can also set up the map scale and layout size and resolution for export. In our <code>atlasLayout</code> example, we set the map scale to 1:100'000 and the export resolution to 300 DPI and the layout size to A4 in landscape orientation. We've added a title and other labels and a scale bar.</p> </li> <li> <p>Once you have your layout ready, we need to generate an Atlas. Still in the print compose, go to the Altas tab and check <code>Generate an Atlas</code>. </p> <p>Select the <code>Division</code> layer as the <code>Coverage layer</code>, it will set up this layer as the grid layer to export fixed page of our project. </p> <p>Make sur to check the option <code>Hidden coverage layer</code>, it will hide the <code>division</code> layer in the outputted result.</p> <p>You can set up a name for each generated page under <code>Page name</code>. In our example, we set it up to <code>to_string(  \"left\") + ' - ' +  to_string( \"bottom\" )</code>. It uses attributes from the <code>Division</code> layer to give the bottom left corner coordinates as page name. </p> <p>Finally, we sort the <code>Division</code> layer by its <code>id</code> attribute.</p> <p></p> </li> <li> <p>Once the Atlas configuration is set, we need to configure the map to use it. In the print compose, select your map item and go to the <code>Item Properties</code> tab and check the option <code>Controlled by Atlas</code>.</p> <p></p> </li> <li> <p>Now, we can test it out inside the print composer. Go to the <code>Atlas menu</code> and click on <code>Preview Atlas</code>. You can now click on the left and right arrow to preview the different pages generated by the Atlas.</p> <p></p> </li> <li> <p>Go back to your QGIS project and make sure that the properties allow to generate more then 1 feature for Atlas print request. Go to <code>Project</code> &gt; <code>Properties</code> &gt; <code>QGIS Server</code> &gt; <code>WMS</code> tab and under <code>Map and Legend Options</code>, adapt the number next to <code>Maximum features for Atlas print request</code> (e.g. 10).</p> <p></p> </li> <li> <p>Now that our print layout using the Altas tool is ready, we can publish our QGIS project in QGIS Server. If you have docker installed and running, you can simply do a <code>Docker compose up</code> being at the root of the <code>qgis-atlas-server</code> folder.</p> <p>When all containers are running, we can test an export by calling the following URL in a browser :</p> <pre><code>http://127.0.0.1:8888/qgis-server?SERVICE=WMS&amp;REQUEST=GetPrint&amp;CRS=EPSG:2056&amp;TEMPLATE=atlasLayout&amp;FORMAT=pdf&amp;ATLAS_PK=122,123,124,125\n</code></pre> <p>This will export 4 PDF pages corresponding to the id <code>122</code>, <code>123</code>, <code>124</code> and <code>125</code> of the <code>Division</code> layer.</p> </li> </ol>"}, {"location": "how-to/qgis-server-atlas/#connect-the-workspace-to-extract", "title": "Connect the workspace to Extract", "text": "<ol> <li> <p>In Extract, create a new or use an existing process (see processes).</p> </li> <li> <p>Drag and drop the task plugin <code>Impression Atlas QGIS Server</code> into the process task list.</p> </li> <li> <p>In the field <code>Url de base QGIS Server</code>, type the URL of your QGIS Server instance. In our example using Docker, you can type <code>http://127.0.0.1:8888/qgis-server</code>. In the field <code>Template \u00e0 utiliser pour le layout</code>, you need to give the print layout name using the Atlas tool. In our example, this is the <code>altasLayout</code>.</p> <p></p> </li> <li> <p>To test the extraction, you can link this process to viageo (see Connect Extract to viageo.ch). With our example, the linked resource can be orderable over the entire Switzerland. The format does not really matter and won't be read by Extract or QGIS. But the plugin will always export files in PDF. So, for clarity for the clients, the format must be set to PDF in viageo.ch. </p> </li> <li> <p>Finally, you can order the linked product on viageo, Extract will retrieve the request and call the GetPrint request of your QGIS Server.</p> </li> </ol> <p> </p>"}, {"location": "misc/viageo-test/", "title": "viageo.ch Validation Instance", "text": "<p>Warning</p> <p>This section is only useful if your organization provides geodata on the platform viageo.ch or plans-reseaux.ch. You must be an ASIT member to distribute geodata through these platforms.</p>"}, {"location": "misc/viageo-test/#fundamentals", "title": "Fundamentals", "text": "<p>The viageo.ch portal consists of two separate environments:</p> <ul> <li>A production instance (PROD) : https://viageo.chThis is available to all users 24/7 (except exceptional maintenance)</li> <li>A validation instance (VAL) : https://val.viageo.ch     Its operation is not guaranteed at all times. It is only available to suppliers (ASIT members) for testing purposes. The sending of notification emails is disabled.</li> </ul>"}, {"location": "misc/viageo-test/#request-for-access-to-the-validation-instance", "title": "Request for access to the validation instance", "text": "<p>Access to the validation instance is restricted by IP address.</p> <p>Please send any access requests to support@viageo.ch, specifying the public IP address (single or range) of the hosts that will need to access it (your workstation, the server where EXTRACT will be installed, etc.).</p>"}, {"location": "misc/viageo-test/#data-replication-between-instances", "title": "Data replication between instances", "text": "<p>Occasionally, data from the production instance is replicated to the validation instance. All your resources will then be updated and replaced with production data.</p> <p></p>"}]}